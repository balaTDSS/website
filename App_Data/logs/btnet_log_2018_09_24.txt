2018-09-24 10:33:49  caught exception in util.set_context:Request is not available in this context
2018-09-24 10:33:49  threadproc_votes
2018-09-24 10:33:49  sql=

if exists (select * from dbo.sysobjects where id = object_id(N'[votes_view]'))
drop view [votes_view]
2018-09-24 10:33:50  started creating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 10:33:50  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 10:33:51  sql=

create view votes_view as
select bu_bug as vote_bug, sum(bu_vote) as vote_total
from bug_user
group by bu_bug
having sum(bu_vote) > 0
2018-09-24 10:33:51  sql=

select bu_bug, count(1)
from bug_user 
where bu_vote = 1
group by bu_bug
2018-09-24 10:33:51  elapsed milliseconds:0049
2018-09-24 10:33:51  elapsed milliseconds:0673
2018-09-24 10:33:51  sql=

select bg_id, 	

isnull(bg_tags,'') bg_tags,
bg_short_desc
from bugs
2018-09-24 10:33:51  elapsed milliseconds:0114
2018-09-24 10:33:51  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
2018-09-24 10:33:51  elapsed milliseconds:0209
2018-09-24 10:33:52  done creating Lucene index
2018-09-24 10:33:52 http://192.168.0.31/default.aspx sql=
select count(1) from users
2018-09-24 11:29:05  caught exception in util.set_context:Request is not available in this context
2018-09-24 11:29:05  threadproc_votes
2018-09-24 11:29:05  sql=

if exists (select * from dbo.sysobjects where id = object_id(N'[votes_view]'))
drop view [votes_view]
2018-09-24 11:29:05  started creating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 11:29:06  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 11:29:07 http://192.168.0.31/default.aspx sql=
select count(1) from users
2018-09-24 11:29:07  sql=

create view votes_view as
select bu_bug as vote_bug, sum(bu_vote) as vote_total
from bug_user
group by bu_bug
having sum(bu_vote) > 0
2018-09-24 11:29:07  sql=

select bu_bug, count(1)
from bug_user 
where bu_vote = 1
group by bu_bug
2018-09-24 11:29:07  elapsed milliseconds:0003
2018-09-24 11:29:07  elapsed milliseconds:0249
2018-09-24 11:29:07  sql=

select bg_id, 	

isnull(bg_tags,'') bg_tags,
bg_short_desc
from bugs
2018-09-24 11:29:07  elapsed milliseconds:0035
2018-09-24 11:29:07  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
2018-09-24 11:29:07  elapsed milliseconds:0167
2018-09-24 11:29:07  done creating Lucene index
2018-09-24 11:29:11 http://192.168.0.31/default.aspx sql=
select count(1) from users
2018-09-24 11:29:11 http://192.168.0.31/default.aspx sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2018-09-24 11:29:11 http://192.168.0.31/default.aspx elapsed milliseconds:0012
2018-09-24 11:29:11 http://192.168.0.31/default.aspx sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2018-09-24 11:29:11 http://192.168.0.31/default.aspx sql=
select us_id from users where us_username = N'admin'
2018-09-24 11:29:11 http://192.168.0.31/default.aspx elapsed milliseconds:0000
2018-09-24 11:29:11 http://192.168.0.31/default.aspx guid=563b8fb5-2324-4870-a63b-4d355f95e775
2018-09-24 11:29:11 http://192.168.0.31/default.aspx sql=
insert into sessions (se_id, se_user) values('563b8fb5-2324-4870-a63b-4d355f95e775', 1)
2018-09-24 11:29:11 http://192.168.0.31/default.aspx AppPath:
2018-09-24 11:29:11 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:29:11 http://192.168.0.31/bugs.aspx elapsed milliseconds:0030
2018-09-24 11:29:11 http://192.168.0.31/bugs.aspx sql=

/* custom columns */ select sc.name, st.[name] [datatype], 
case when st.[name] = 'nvarchar' or st.[name] = 'nchar' then sc.length/2 else sc.length end as [length], 
sc.xprec, sc.xscale, sc.isnullable,
mm.text [default value], 
dflts.name [default name], 
isnull(ccm_dropdown_type,'') [dropdown type],
isnull(ccm_dropdown_vals,'') [vals],
isnull(ccm_sort_seq, sc.colorder) [column order],
sc.colorder
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
left outer join syscomments mm on sc.cdefault = mm.id
left outer join custom_col_metadata on ccm_colorder = sc.colorder
left outer join sysobjects dflts on dflts.id = mm.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
order by sc.id, isnull(ccm_sort_seq,sc.colorder)
2018-09-24 11:29:12 http://192.168.0.31/bugs.aspx elapsed milliseconds:1080
2018-09-24 11:29:12 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:29:12 http://192.168.0.31/bugs.aspx elapsed milliseconds:0062
2018-09-24 11:29:12 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2018-09-24 11:29:12 http://192.168.0.31/bugs.aspx elapsed milliseconds:0006
2018-09-24 11:29:12 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:29:12 http://192.168.0.31/bugs.aspx elapsed milliseconds:0030
2018-09-24 11:36:38 http://192.168.0.31/ajax.aspx?bugid=22 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:36:39 http://192.168.0.31/ajax.aspx?bugid=22 elapsed milliseconds:0040
2018-09-24 11:36:39 http://192.168.0.31/ajax.aspx?bugid=22 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 22
2018-09-24 11:36:39 http://192.168.0.31/ajax.aspx?bugid=22 elapsed milliseconds:0012
2018-09-24 11:36:39 http://192.168.0.31/ajax.aspx?bugid=22 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 22
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:36:39 http://192.168.0.31/ajax.aspx?bugid=22 elapsed milliseconds:0026
2018-09-24 11:36:44 http://192.168.0.31/ajax.aspx?bugid=35 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:36:44 http://192.168.0.31/ajax.aspx?bugid=35 elapsed milliseconds:0001
2018-09-24 11:36:44 http://192.168.0.31/ajax.aspx?bugid=35 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 35
2018-09-24 11:36:44 http://192.168.0.31/ajax.aspx?bugid=35 elapsed milliseconds:0006
2018-09-24 11:36:44 http://192.168.0.31/ajax.aspx?bugid=35 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 35
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:36:44 http://192.168.0.31/ajax.aspx?bugid=35 elapsed milliseconds:0018
2018-09-24 11:36:44 http://192.168.0.31/ajax.aspx?bugid=36 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:36:44 http://192.168.0.31/ajax.aspx?bugid=36 elapsed milliseconds:0001
2018-09-24 11:36:44 http://192.168.0.31/ajax.aspx?bugid=36 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 36
2018-09-24 11:36:44 http://192.168.0.31/ajax.aspx?bugid=36 elapsed milliseconds:0006
2018-09-24 11:36:44 http://192.168.0.31/ajax.aspx?bugid=36 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 36
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:36:44 http://192.168.0.31/ajax.aspx?bugid=36 elapsed milliseconds:0017
2018-09-24 11:36:44 http://192.168.0.31/edit_bug.aspx?id=36 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:36:44 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0000
2018-09-24 11:36:44 http://192.168.0.31/edit_bug.aspx?id=36 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 36
2018-09-24 11:36:44 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0019
2018-09-24 11:36:44 http://192.168.0.31/edit_bug.aspx?id=36 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2018-09-24 11:36:44 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0005
2018-09-24 11:36:44 http://192.168.0.31/edit_bug.aspx?id=36 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 4
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:36:44 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0005
2018-09-24 11:36:44 http://192.168.0.31/edit_bug.aspx?id=36 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 4
2018-09-24 11:36:44 http://192.168.0.31/edit_bug.aspx?id=36 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 4
2018-09-24 11:36:44 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0001
2018-09-24 11:36:44 http://192.168.0.31/edit_bug.aspx?id=36 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 36
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:36:44 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0000
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0008
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 36
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0017
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 10 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 12
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 4
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 36
		if @last_updated > '20180924 11:36:44:853'
		begin
			-- signal that we did NOT do the update
			set @now = '20180924 11:36:44:853'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'DOB/MRN',
			bg_tags = N'',
			bg_project = 4,
			bg_org = 10,
			bg_category = 1,
			bg_priority = 0,
			bg_assigned_to_user = 12,
			bg_status = 10,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'v61049',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 36
		end
		select @now
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 36

delete from bug_subscriptions
where bs_bug = 36
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 36
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 36
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 36, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 36
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 36)

insert into bug_subscriptions (bs_bug, bs_user)
select 36, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 36)

insert into bug_subscriptions (bs_bug, bs_user)
select 36, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 36
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 36)

insert into bug_subscriptions (bs_bug, bs_user)
select 36, us_id
from users
inner join bugs on bg_id = 36
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 36)
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 sql=
select count(1) from bug_subscriptions where bs_bug = 36 and bs_user = 1
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(36, 1, getdate(), N'changed assigned_to from "[not assigned]" to "manager1"', 'update')
		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(36, 1, getdate(), N'changed status from "New" to "Approved"', 'update')
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (2 <= us_reported_notifications and bg_reported_user = bs_user)
or (2 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (2 <= us_assigned_notifications and 12 = bs_user)
or (2 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 36
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2018-09-24 11:37:18  started updating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0021
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 36
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0000
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 4
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0011
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 4
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0001
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 36
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:37:18 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0006
2018-09-24 11:37:18  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 11:37:18  elapsed milliseconds:0029
2018-09-24 11:37:18  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 36
2018-09-24 11:37:18  elapsed milliseconds:0000
2018-09-24 11:37:18  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 36
2018-09-24 11:37:18  elapsed milliseconds:0001
2018-09-24 11:37:18  done updating Lucene index
2018-09-24 11:37:22 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:37:22 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:37:22 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:37:22 http://192.168.0.31/bugs.aspx elapsed milliseconds:0002
2018-09-24 11:37:22 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2018-09-24 11:37:22 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:37:22 http://192.168.0.31/bugs.aspx elapsed milliseconds:0014
2018-09-24 11:37:28 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:37:28 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:37:28 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 17
2018-09-24 11:37:28 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
--isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','Open','In-Process','Ready to deploy','Hold') then  'New' else st_name end,'')[status],

 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
 where /* altered - both  */ (  bg_status = 3  ) AND (  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0))  ) order by bg_id desc
2018-09-24 11:37:28 http://192.168.0.31/bugs.aspx elapsed milliseconds:0010
2018-09-24 11:37:30 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:37:30 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:37:30 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 3
2018-09-24 11:37:30 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by],bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
 where /* altered - both  */ (  bg_status <> 5 and bg_assigned_to_user = 1  ) AND (  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0))  ) order by bg_id desc
2018-09-24 11:37:30 http://192.168.0.31/bugs.aspx elapsed milliseconds:0010
2018-09-24 11:37:31 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:37:31 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:37:31 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 2
2018-09-24 11:37:31 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project],isnull(bg_project_custom_dropdown_value1,'') [Version],
  isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
 where /* altered - both  */ (  bg_status <> 5  ) AND (  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0))  ) order by bg_id desc
2018-09-24 11:37:31 http://192.168.0.31/bugs.aspx elapsed milliseconds:0012
2018-09-24 11:37:34 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:37:34 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:37:34 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 16
2018-09-24 11:37:34 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status], 
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected', 'Ready to deploy','Hold') then 'New' else st_name end,'')[status], 
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc 
2018-09-24 11:37:34 http://192.168.0.31/bugs.aspx elapsed milliseconds:0016
2018-09-24 11:37:45 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:37:45 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:37:45 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 18
2018-09-24 11:37:45 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','open','In-process','Programming Completed','QC Completed','Re-Open','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:37:45 http://192.168.0.31/bugs.aspx elapsed milliseconds:0015
2018-09-24 11:37:49 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:37:49 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:37:49 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 11
2018-09-24 11:37:49 http://192.168.0.31/bugs.aspx sql=
select bg_id ,bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc],
 isnull(pj_name,'') [project], 
isnull(bg_project_custom_dropdown_value1,'') [Version],
 isnull(og_name,'') [organization],
 isnull(ct_name,'') [category], 
rpt.us_username [reported by],
 bg_reported_date [reported on],  
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Programing Completed','QC Completed','Re-Open','Ready to deploy','Hold') then  'In-Process' else st_name end,'')[status],
 bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
-- left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:37:49 http://192.168.0.31/bugs.aspx elapsed milliseconds:0017
2018-09-24 11:38:00 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:00 http://192.168.0.31/bugs.aspx elapsed milliseconds:0007
2018-09-24 11:38:00 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:38:00 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:38:00 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 11
2018-09-24 11:38:00 http://192.168.0.31/bugs.aspx sql=
select bg_id ,bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc],
 isnull(pj_name,'') [project], 
isnull(bg_project_custom_dropdown_value1,'') [Version],
 isnull(og_name,'') [organization],
 isnull(ct_name,'') [category], 
rpt.us_username [reported by],
 bg_reported_date [reported on],  
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Programing Completed','QC Completed','Re-Open','Ready to deploy','Hold') then  'In-Process' else st_name end,'')[status],
 bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
-- left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:38:00 http://192.168.0.31/bugs.aspx elapsed milliseconds:0019
2018-09-24 11:38:01 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:01 http://192.168.0.31/bugs.aspx elapsed milliseconds:0025
2018-09-24 11:38:01 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:38:01 http://192.168.0.31/bugs.aspx elapsed milliseconds:0002
2018-09-24 11:38:01 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 11
2018-09-24 11:38:01 http://192.168.0.31/bugs.aspx sql=
select bg_id ,bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc],
 isnull(pj_name,'') [project], 
isnull(bg_project_custom_dropdown_value1,'') [Version],
 isnull(og_name,'') [organization],
 isnull(ct_name,'') [category], 
rpt.us_username [reported by],
 bg_reported_date [reported on],  
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Programing Completed','QC Completed','Re-Open','Ready to deploy','Hold') then  'In-Process' else st_name end,'')[status],
 bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
-- left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:38:01 http://192.168.0.31/bugs.aspx elapsed milliseconds:0034
2018-09-24 11:38:03 http://192.168.0.31/ajax.aspx?bugid=35 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:03 http://192.168.0.31/ajax.aspx?bugid=35 elapsed milliseconds:0001
2018-09-24 11:38:03 http://192.168.0.31/ajax.aspx?bugid=35 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 35
2018-09-24 11:38:03 http://192.168.0.31/ajax.aspx?bugid=35 elapsed milliseconds:0006
2018-09-24 11:38:03 http://192.168.0.31/ajax.aspx?bugid=35 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 35
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:03 http://192.168.0.31/ajax.aspx?bugid=35 elapsed milliseconds:0015
2018-09-24 11:38:03 http://192.168.0.31/edit_bug.aspx?id=35 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:03 http://192.168.0.31/edit_bug.aspx?id=35 elapsed milliseconds:0000
2018-09-24 11:38:03 http://192.168.0.31/edit_bug.aspx?id=35 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 35
2018-09-24 11:38:03 http://192.168.0.31/edit_bug.aspx?id=35 elapsed milliseconds:0017
2018-09-24 11:38:03 http://192.168.0.31/edit_bug.aspx?id=35 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2018-09-24 11:38:03 http://192.168.0.31/edit_bug.aspx?id=35 elapsed milliseconds:0004
2018-09-24 11:38:03 http://192.168.0.31/edit_bug.aspx?id=35 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 4
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:03 http://192.168.0.31/edit_bug.aspx?id=35 elapsed milliseconds:0004
2018-09-24 11:38:03 http://192.168.0.31/edit_bug.aspx?id=35 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 4
2018-09-24 11:38:03 http://192.168.0.31/edit_bug.aspx?id=35 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 4
2018-09-24 11:38:03 http://192.168.0.31/edit_bug.aspx?id=35 elapsed milliseconds:0000
2018-09-24 11:38:03 http://192.168.0.31/edit_bug.aspx?id=35 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 35
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:03 http://192.168.0.31/edit_bug.aspx?id=35 elapsed milliseconds:0000
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 elapsed milliseconds:0000
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 35
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 elapsed milliseconds:0000
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 4
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 35
		if @last_updated > '20180924 11:38:03:437'
		begin
			-- signal that we did NOT do the update
			set @now = '20180924 11:38:03:437'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'WCC Search window',
			bg_tags = N'',
			bg_project = 4,
			bg_org = 10,
			bg_category = 2,
			bg_priority = 0,
			bg_assigned_to_user = 0,
			bg_status = 9,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'v61046',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 35
		end
		select @now
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 35

delete from bug_subscriptions
where bs_bug = 35
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 35
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 35
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 35, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 35
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 35)

insert into bug_subscriptions (bs_bug, bs_user)
select 35, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 35)

insert into bug_subscriptions (bs_bug, bs_user)
select 35, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 35
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 35)

insert into bug_subscriptions (bs_bug, bs_user)
select 35, us_id
from users
inner join bugs on bg_id = 35
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 35)
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 sql=
select count(1) from bug_subscriptions where bs_bug = 35 and bs_user = 1
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(35, 1, getdate(), N'changed status from "New" to "Waiting for approval"', 'update')
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (2 <= us_reported_notifications and bg_reported_user = bs_user)
or (2 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (2 <= us_assigned_notifications and 0 = bs_user)
or (2 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 35
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2018-09-24 11:38:09  started updating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 11:38:09  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 elapsed milliseconds:0007
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 35
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 elapsed milliseconds:0000
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 4
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:09 http://192.168.0.31/edit_bug.aspx?id=35 elapsed milliseconds:0000
2018-09-24 11:38:10 http://192.168.0.31/edit_bug.aspx?id=35 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 4
2018-09-24 11:38:10 http://192.168.0.31/edit_bug.aspx?id=35 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 4
2018-09-24 11:38:10 http://192.168.0.31/edit_bug.aspx?id=35 elapsed milliseconds:0000
2018-09-24 11:38:10 http://192.168.0.31/edit_bug.aspx?id=35 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 35
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:10 http://192.168.0.31/edit_bug.aspx?id=35 elapsed milliseconds:0000
2018-09-24 11:38:10  elapsed milliseconds:0021
2018-09-24 11:38:10  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 35
2018-09-24 11:38:10  elapsed milliseconds:0001
2018-09-24 11:38:10  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 35
2018-09-24 11:38:10  elapsed milliseconds:0001
2018-09-24 11:38:10  done updating Lucene index
2018-09-24 11:38:12 http://192.168.0.31/edit_bug.aspx?id=34 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:12 http://192.168.0.31/edit_bug.aspx?id=34 elapsed milliseconds:0000
2018-09-24 11:38:12 http://192.168.0.31/edit_bug.aspx?id=34 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 34
2018-09-24 11:38:12 http://192.168.0.31/edit_bug.aspx?id=34 elapsed milliseconds:0014
2018-09-24 11:38:12 http://192.168.0.31/edit_bug.aspx?id=34 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2018-09-24 11:38:12 http://192.168.0.31/edit_bug.aspx?id=34 elapsed milliseconds:0000
2018-09-24 11:38:12 http://192.168.0.31/edit_bug.aspx?id=34 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 4
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:12 http://192.168.0.31/edit_bug.aspx?id=34 elapsed milliseconds:0000
2018-09-24 11:38:12 http://192.168.0.31/edit_bug.aspx?id=34 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 4
2018-09-24 11:38:12 http://192.168.0.31/edit_bug.aspx?id=34 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 4
2018-09-24 11:38:12 http://192.168.0.31/edit_bug.aspx?id=34 elapsed milliseconds:0000
2018-09-24 11:38:12 http://192.168.0.31/edit_bug.aspx?id=34 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 34
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:12 http://192.168.0.31/edit_bug.aspx?id=34 elapsed milliseconds:0005
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 elapsed milliseconds:0000
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 34
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 elapsed milliseconds:0000
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 4
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 34
		if @last_updated > '20180924 11:38:12:690'
		begin
			-- signal that we did NOT do the update
			set @now = '20180924 11:38:12:690'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'WCC - Edit window',
			bg_tags = N'',
			bg_project = 4,
			bg_org = 10,
			bg_category = 2,
			bg_priority = 0,
			bg_assigned_to_user = 0,
			bg_status = 11,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'v61034',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 34
		end
		select @now
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 34

delete from bug_subscriptions
where bs_bug = 34
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 34
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 34
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 34, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 34
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 34)

insert into bug_subscriptions (bs_bug, bs_user)
select 34, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 34)

insert into bug_subscriptions (bs_bug, bs_user)
select 34, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 34
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 34)

insert into bug_subscriptions (bs_bug, bs_user)
select 34, us_id
from users
inner join bugs on bg_id = 34
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 34)
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 sql=
select count(1) from bug_subscriptions where bs_bug = 34 and bs_user = 1
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(34, 1, getdate(), N'changed status from "New" to " Rejected"', 'update')
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (2 <= us_reported_notifications and bg_reported_user = bs_user)
or (2 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (2 <= us_assigned_notifications and 0 = bs_user)
or (2 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 34
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2018-09-24 11:38:20  started updating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 11:38:20  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 11:38:20  elapsed milliseconds:0000
2018-09-24 11:38:20  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 34
2018-09-24 11:38:20  elapsed milliseconds:0000
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 elapsed milliseconds:0008
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 34
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 elapsed milliseconds:0000
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 4
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 elapsed milliseconds:0000
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 4
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 4
2018-09-24 11:38:20  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 34
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 elapsed milliseconds:0000
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 34
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:20 http://192.168.0.31/edit_bug.aspx?id=34 elapsed milliseconds:0000
2018-09-24 11:38:20  elapsed milliseconds:0001
2018-09-24 11:38:20  done updating Lucene index
2018-09-24 11:38:22 http://192.168.0.31/edit_bug.aspx?id=33 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:22 http://192.168.0.31/edit_bug.aspx?id=33 elapsed milliseconds:0000
2018-09-24 11:38:22 http://192.168.0.31/edit_bug.aspx?id=33 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 33
2018-09-24 11:38:22 http://192.168.0.31/edit_bug.aspx?id=33 elapsed milliseconds:0014
2018-09-24 11:38:22 http://192.168.0.31/edit_bug.aspx?id=33 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2018-09-24 11:38:22 http://192.168.0.31/edit_bug.aspx?id=33 elapsed milliseconds:0000
2018-09-24 11:38:22 http://192.168.0.31/edit_bug.aspx?id=33 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 3
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:22 http://192.168.0.31/edit_bug.aspx?id=33 elapsed milliseconds:0004
2018-09-24 11:38:22 http://192.168.0.31/edit_bug.aspx?id=33 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 3
2018-09-24 11:38:22 http://192.168.0.31/edit_bug.aspx?id=33 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 3
2018-09-24 11:38:22 http://192.168.0.31/edit_bug.aspx?id=33 elapsed milliseconds:0000
2018-09-24 11:38:22 http://192.168.0.31/edit_bug.aspx?id=33 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 33
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:22 http://192.168.0.31/edit_bug.aspx?id=33 elapsed milliseconds:0004
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 elapsed milliseconds:0000
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 33
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 elapsed milliseconds:0000
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 3
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 33
		if @last_updated > '20180924 11:38:22:150'
		begin
			-- signal that we did NOT do the update
			set @now = '20180924 11:38:22:150'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'Patient Find Window',
			bg_tags = N'',
			bg_project = 3,
			bg_org = 10,
			bg_category = 2,
			bg_priority = 0,
			bg_assigned_to_user = 0,
			bg_status = 12,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'v61046',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 33
		end
		select @now
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 33

delete from bug_subscriptions
where bs_bug = 33
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 33
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 33
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 33, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 33
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 33)

insert into bug_subscriptions (bs_bug, bs_user)
select 33, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 33)

insert into bug_subscriptions (bs_bug, bs_user)
select 33, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 33
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 33)

insert into bug_subscriptions (bs_bug, bs_user)
select 33, us_id
from users
inner join bugs on bg_id = 33
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 33)
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 sql=
select count(1) from bug_subscriptions where bs_bug = 33 and bs_user = 1
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(33, 1, getdate(), N'changed status from "New" to "Open"', 'update')
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (2 <= us_reported_notifications and bg_reported_user = bs_user)
or (2 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (2 <= us_assigned_notifications and 0 = bs_user)
or (2 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 33
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2018-09-24 11:38:25  started updating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 11:38:25  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 11:38:25  elapsed milliseconds:0000
2018-09-24 11:38:25  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 33
2018-09-24 11:38:25  elapsed milliseconds:0000
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 elapsed milliseconds:0008
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 33
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 elapsed milliseconds:0000
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 3
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 elapsed milliseconds:0000
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 3
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 3
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 elapsed milliseconds:0000
2018-09-24 11:38:25  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 33
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 33
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:25 http://192.168.0.31/edit_bug.aspx?id=33 elapsed milliseconds:0000
2018-09-24 11:38:25  elapsed milliseconds:0001
2018-09-24 11:38:25  done updating Lucene index
2018-09-24 11:38:26 http://192.168.0.31/edit_bug.aspx?id=32 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:26 http://192.168.0.31/edit_bug.aspx?id=32 elapsed milliseconds:0000
2018-09-24 11:38:26 http://192.168.0.31/edit_bug.aspx?id=32 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 32
2018-09-24 11:38:26 http://192.168.0.31/edit_bug.aspx?id=32 elapsed milliseconds:0014
2018-09-24 11:38:26 http://192.168.0.31/edit_bug.aspx?id=32 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2018-09-24 11:38:26 http://192.168.0.31/edit_bug.aspx?id=32 elapsed milliseconds:0000
2018-09-24 11:38:26 http://192.168.0.31/edit_bug.aspx?id=32 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 3
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:26 http://192.168.0.31/edit_bug.aspx?id=32 elapsed milliseconds:0000
2018-09-24 11:38:26 http://192.168.0.31/edit_bug.aspx?id=32 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 3
2018-09-24 11:38:26 http://192.168.0.31/edit_bug.aspx?id=32 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 3
2018-09-24 11:38:26 http://192.168.0.31/edit_bug.aspx?id=32 elapsed milliseconds:0000
2018-09-24 11:38:26 http://192.168.0.31/edit_bug.aspx?id=32 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 32
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:26 http://192.168.0.31/edit_bug.aspx?id=32 elapsed milliseconds:0004
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 elapsed milliseconds:0000
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 32
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 elapsed milliseconds:0000
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 3
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 32
		if @last_updated > '20180924 11:38:26:820'
		begin
			-- signal that we did NOT do the update
			set @now = '20180924 11:38:26:820'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'CMMC - Unit View',
			bg_tags = N'',
			bg_project = 3,
			bg_org = 10,
			bg_category = 4,
			bg_priority = 0,
			bg_assigned_to_user = 0,
			bg_status = 13,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'v61034',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 32
		end
		select @now
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 32

delete from bug_subscriptions
where bs_bug = 32
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 32
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 32
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 32, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 32
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 32)

insert into bug_subscriptions (bs_bug, bs_user)
select 32, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 32)

insert into bug_subscriptions (bs_bug, bs_user)
select 32, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 32
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 32)

insert into bug_subscriptions (bs_bug, bs_user)
select 32, us_id
from users
inner join bugs on bg_id = 32
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 32)
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 sql=
select count(1) from bug_subscriptions where bs_bug = 32 and bs_user = 1
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(32, 1, getdate(), N'changed status from "New" to "In-Process"', 'update')
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (2 <= us_reported_notifications and bg_reported_user = bs_user)
or (2 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (2 <= us_assigned_notifications and 0 = bs_user)
or (2 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 32
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2018-09-24 11:38:30  started updating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 11:38:30  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 11:38:30  elapsed milliseconds:0000
2018-09-24 11:38:30  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 32
2018-09-24 11:38:30  elapsed milliseconds:0000
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 elapsed milliseconds:0008
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 32
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 elapsed milliseconds:0000
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 3
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 elapsed milliseconds:0000
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 3
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 3
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 elapsed milliseconds:0000
2018-09-24 11:38:30  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 32
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 32
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:30 http://192.168.0.31/edit_bug.aspx?id=32 elapsed milliseconds:0000
2018-09-24 11:38:30  elapsed milliseconds:0001
2018-09-24 11:38:30  done updating Lucene index
2018-09-24 11:38:31 http://192.168.0.31/edit_bug.aspx?id=31 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:31 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:38:31 http://192.168.0.31/edit_bug.aspx?id=31 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 31
2018-09-24 11:38:31 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0014
2018-09-24 11:38:31 http://192.168.0.31/edit_bug.aspx?id=31 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2018-09-24 11:38:31 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:38:31 http://192.168.0.31/edit_bug.aspx?id=31 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 3
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:31 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:38:31 http://192.168.0.31/edit_bug.aspx?id=31 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 3
2018-09-24 11:38:31 http://192.168.0.31/edit_bug.aspx?id=31 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 3
2018-09-24 11:38:31 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:38:31 http://192.168.0.31/edit_bug.aspx?id=31 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 31
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:31 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0004
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 31
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 3
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 31
		if @last_updated > '20180924 11:38:31:273'
		begin
			-- signal that we did NOT do the update
			set @now = '20180924 11:38:31:273'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'Bed Boards',
			bg_tags = N'',
			bg_project = 3,
			bg_org = 10,
			bg_category = 2,
			bg_priority = 0,
			bg_assigned_to_user = 0,
			bg_status = 14,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'v61034',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 31
		end
		select @now
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 31

delete from bug_subscriptions
where bs_bug = 31
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 31
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 31
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 31, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 31
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 31)

insert into bug_subscriptions (bs_bug, bs_user)
select 31, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 31)

insert into bug_subscriptions (bs_bug, bs_user)
select 31, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 31
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 31)

insert into bug_subscriptions (bs_bug, bs_user)
select 31, us_id
from users
inner join bugs on bg_id = 31
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 31)
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 sql=
select count(1) from bug_subscriptions where bs_bug = 31 and bs_user = 1
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(31, 1, getdate(), N'changed status from "New" to "Programing Completed"', 'update')
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (2 <= us_reported_notifications and bg_reported_user = bs_user)
or (2 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (2 <= us_assigned_notifications and 0 = bs_user)
or (2 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 31
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2018-09-24 11:38:37  started updating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 11:38:37  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 11:38:37  elapsed milliseconds:0000
2018-09-24 11:38:37  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 31
2018-09-24 11:38:37  elapsed milliseconds:0000
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0007
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 31
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 3
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 3
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 3
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:38:37  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 31
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 31
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:37 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:38:37  elapsed milliseconds:0001
2018-09-24 11:38:37  done updating Lucene index
2018-09-24 11:38:39 http://192.168.0.31/edit_bug.aspx?id=30 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:39 http://192.168.0.31/edit_bug.aspx?id=30 elapsed milliseconds:0000
2018-09-24 11:38:39 http://192.168.0.31/edit_bug.aspx?id=30 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 30
2018-09-24 11:38:39 http://192.168.0.31/edit_bug.aspx?id=30 elapsed milliseconds:0014
2018-09-24 11:38:39 http://192.168.0.31/edit_bug.aspx?id=30 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2018-09-24 11:38:39 http://192.168.0.31/edit_bug.aspx?id=30 elapsed milliseconds:0000
2018-09-24 11:38:39 http://192.168.0.31/edit_bug.aspx?id=30 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 5
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:39 http://192.168.0.31/edit_bug.aspx?id=30 elapsed milliseconds:0004
2018-09-24 11:38:39 http://192.168.0.31/edit_bug.aspx?id=30 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 5
2018-09-24 11:38:39 http://192.168.0.31/edit_bug.aspx?id=30 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 5
2018-09-24 11:38:39 http://192.168.0.31/edit_bug.aspx?id=30 elapsed milliseconds:0000
2018-09-24 11:38:39 http://192.168.0.31/edit_bug.aspx?id=30 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 30
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:39 http://192.168.0.31/edit_bug.aspx?id=30 elapsed milliseconds:0004
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 elapsed milliseconds:0000
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 30
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 elapsed milliseconds:0000
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 5
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 30
		if @last_updated > '20180924 11:38:39:460'
		begin
			-- signal that we did NOT do the update
			set @now = '20180924 11:38:39:460'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'ConfigID Issue',
			bg_tags = N'',
			bg_project = 5,
			bg_org = 10,
			bg_category = 2,
			bg_priority = 0,
			bg_assigned_to_user = 0,
			bg_status = 15,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'v61034',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 30
		end
		select @now
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 30

delete from bug_subscriptions
where bs_bug = 30
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 30
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 30
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 30, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 30
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 30)

insert into bug_subscriptions (bs_bug, bs_user)
select 30, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 30)

insert into bug_subscriptions (bs_bug, bs_user)
select 30, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 30
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 30)

insert into bug_subscriptions (bs_bug, bs_user)
select 30, us_id
from users
inner join bugs on bg_id = 30
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 30)
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 sql=
select count(1) from bug_subscriptions where bs_bug = 30 and bs_user = 1
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(30, 1, getdate(), N'changed status from "New" to "QC Completed"', 'update')
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (2 <= us_reported_notifications and bg_reported_user = bs_user)
or (2 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (2 <= us_assigned_notifications and 0 = bs_user)
or (2 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 30
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2018-09-24 11:38:43  started updating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 11:38:43  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 11:38:43  elapsed milliseconds:0000
2018-09-24 11:38:43  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 30
2018-09-24 11:38:43  elapsed milliseconds:0000
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 elapsed milliseconds:0008
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 30
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 elapsed milliseconds:0000
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 5
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 elapsed milliseconds:0000
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 5
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 5
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 elapsed milliseconds:0000
2018-09-24 11:38:43  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 30
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 30
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:43 http://192.168.0.31/edit_bug.aspx?id=30 elapsed milliseconds:0000
2018-09-24 11:38:43  elapsed milliseconds:0001
2018-09-24 11:38:43  done updating Lucene index
2018-09-24 11:38:46 http://192.168.0.31/edit_bug.aspx?id=29 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:46 http://192.168.0.31/edit_bug.aspx?id=29 elapsed milliseconds:0000
2018-09-24 11:38:46 http://192.168.0.31/edit_bug.aspx?id=29 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 29
2018-09-24 11:38:46 http://192.168.0.31/edit_bug.aspx?id=29 elapsed milliseconds:0014
2018-09-24 11:38:46 http://192.168.0.31/edit_bug.aspx?id=29 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2018-09-24 11:38:46 http://192.168.0.31/edit_bug.aspx?id=29 elapsed milliseconds:0000
2018-09-24 11:38:46 http://192.168.0.31/edit_bug.aspx?id=29 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 7
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:46 http://192.168.0.31/edit_bug.aspx?id=29 elapsed milliseconds:0004
2018-09-24 11:38:46 http://192.168.0.31/edit_bug.aspx?id=29 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 7
2018-09-24 11:38:46 http://192.168.0.31/edit_bug.aspx?id=29 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 7
2018-09-24 11:38:46 http://192.168.0.31/edit_bug.aspx?id=29 elapsed milliseconds:0000
2018-09-24 11:38:46 http://192.168.0.31/edit_bug.aspx?id=29 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 29
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:46 http://192.168.0.31/edit_bug.aspx?id=29 elapsed milliseconds:0004
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 elapsed milliseconds:0000
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 29
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 elapsed milliseconds:0000
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 7
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 29
		if @last_updated > '20180924 11:38:46:453'
		begin
			-- signal that we did NOT do the update
			set @now = '20180924 11:38:46:453'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'EVS reports',
			bg_tags = N'',
			bg_project = 7,
			bg_org = 10,
			bg_category = 2,
			bg_priority = 0,
			bg_assigned_to_user = 0,
			bg_status = 16,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'Select',
bg_project_custom_dropdown_value2 = N'Select',
bg_project_custom_dropdown_value3 = N'Select'
	
			
			where bg_id = 29
		end
		select @now
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 29

delete from bug_subscriptions
where bs_bug = 29
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 29
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 29
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 29, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 29
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 29)

insert into bug_subscriptions (bs_bug, bs_user)
select 29, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 29)

insert into bug_subscriptions (bs_bug, bs_user)
select 29, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 29
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 29)

insert into bug_subscriptions (bs_bug, bs_user)
select 29, us_id
from users
inner join bugs on bg_id = 29
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 29)
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 sql=
select count(1) from bug_subscriptions where bs_bug = 29 and bs_user = 1
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(29, 1, getdate(), N'changed status from "New" to "Re-Open"', 'update')
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (2 <= us_reported_notifications and bg_reported_user = bs_user)
or (2 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (2 <= us_assigned_notifications and 0 = bs_user)
or (2 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 29
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2018-09-24 11:38:51  started updating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 11:38:51  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 11:38:51  elapsed milliseconds:0000
2018-09-24 11:38:51  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 29
2018-09-24 11:38:51  elapsed milliseconds:0000
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 elapsed milliseconds:0008
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 29
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 elapsed milliseconds:0000
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 7
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 elapsed milliseconds:0000
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 7
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 7
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 elapsed milliseconds:0000
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 29
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:51  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 29
2018-09-24 11:38:51 http://192.168.0.31/edit_bug.aspx?id=29 elapsed milliseconds:0000
2018-09-24 11:38:51  elapsed milliseconds:0001
2018-09-24 11:38:51  done updating Lucene index
2018-09-24 11:38:53 http://192.168.0.31/edit_bug.aspx?id=28 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:53 http://192.168.0.31/edit_bug.aspx?id=28 elapsed milliseconds:0000
2018-09-24 11:38:53 http://192.168.0.31/edit_bug.aspx?id=28 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 28
2018-09-24 11:38:53 http://192.168.0.31/edit_bug.aspx?id=28 elapsed milliseconds:0018
2018-09-24 11:38:53 http://192.168.0.31/edit_bug.aspx?id=28 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2018-09-24 11:38:53 http://192.168.0.31/edit_bug.aspx?id=28 elapsed milliseconds:0000
2018-09-24 11:38:53 http://192.168.0.31/edit_bug.aspx?id=28 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 6
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:53 http://192.168.0.31/edit_bug.aspx?id=28 elapsed milliseconds:0004
2018-09-24 11:38:53 http://192.168.0.31/edit_bug.aspx?id=28 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 6
2018-09-24 11:38:53 http://192.168.0.31/edit_bug.aspx?id=28 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 6
2018-09-24 11:38:53 http://192.168.0.31/edit_bug.aspx?id=28 elapsed milliseconds:0000
2018-09-24 11:38:53 http://192.168.0.31/edit_bug.aspx?id=28 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 28
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:53 http://192.168.0.31/edit_bug.aspx?id=28 elapsed milliseconds:0004
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 elapsed milliseconds:0000
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 28
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 elapsed milliseconds:0000
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 6
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 28
		if @last_updated > '20180924 11:38:53:387'
		begin
			-- signal that we did NOT do the update
			set @now = '20180924 11:38:53:387'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'Comm Server issue',
			bg_tags = N'',
			bg_project = 6,
			bg_org = 10,
			bg_category = 2,
			bg_priority = 0,
			bg_assigned_to_user = 0,
			bg_status = 17,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'v61035',
bg_project_custom_dropdown_value2 = N'Select',
bg_project_custom_dropdown_value3 = N'Select'
	
			
			where bg_id = 28
		end
		select @now
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 28

delete from bug_subscriptions
where bs_bug = 28
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 28
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 28
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 28, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 28
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 28)

insert into bug_subscriptions (bs_bug, bs_user)
select 28, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 28)

insert into bug_subscriptions (bs_bug, bs_user)
select 28, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 28
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 28)

insert into bug_subscriptions (bs_bug, bs_user)
select 28, us_id
from users
inner join bugs on bg_id = 28
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 28)
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 sql=
select count(1) from bug_subscriptions where bs_bug = 28 and bs_user = 1
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(28, 1, getdate(), N'changed status from "New" to "Ready to deploy"', 'update')
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (2 <= us_reported_notifications and bg_reported_user = bs_user)
or (2 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (2 <= us_assigned_notifications and 0 = bs_user)
or (2 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 28
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2018-09-24 11:38:57  started updating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 11:38:57  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 11:38:57  elapsed milliseconds:0000
2018-09-24 11:38:57  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 28
2018-09-24 11:38:57  elapsed milliseconds:0000
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 elapsed milliseconds:0008
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 28
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 elapsed milliseconds:0000
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 6
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 elapsed milliseconds:0000
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 6
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 6
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 elapsed milliseconds:0000
2018-09-24 11:38:57  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 28
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 28
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:57 http://192.168.0.31/edit_bug.aspx?id=28 elapsed milliseconds:0000
2018-09-24 11:38:57  elapsed milliseconds:0001
2018-09-24 11:38:57  done updating Lucene index
2018-09-24 11:38:58 http://192.168.0.31/edit_bug.aspx?id=27 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:38:58 http://192.168.0.31/edit_bug.aspx?id=27 elapsed milliseconds:0000
2018-09-24 11:38:58 http://192.168.0.31/edit_bug.aspx?id=27 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 27
2018-09-24 11:38:58 http://192.168.0.31/edit_bug.aspx?id=27 elapsed milliseconds:0014
2018-09-24 11:38:58 http://192.168.0.31/edit_bug.aspx?id=27 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2018-09-24 11:38:58 http://192.168.0.31/edit_bug.aspx?id=27 elapsed milliseconds:0000
2018-09-24 11:38:58 http://192.168.0.31/edit_bug.aspx?id=27 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 6
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:38:58 http://192.168.0.31/edit_bug.aspx?id=27 elapsed milliseconds:0000
2018-09-24 11:38:58 http://192.168.0.31/edit_bug.aspx?id=27 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 6
2018-09-24 11:38:58 http://192.168.0.31/edit_bug.aspx?id=27 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 6
2018-09-24 11:38:58 http://192.168.0.31/edit_bug.aspx?id=27 elapsed milliseconds:0000
2018-09-24 11:38:58 http://192.168.0.31/edit_bug.aspx?id=27 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 27
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:38:58 http://192.168.0.31/edit_bug.aspx?id=27 elapsed milliseconds:0005
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 elapsed milliseconds:0000
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 27
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 elapsed milliseconds:0000
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 6
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 27
		if @last_updated > '20180924 11:38:58:873'
		begin
			-- signal that we did NOT do the update
			set @now = '20180924 11:38:58:873'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'Mobile Manager ',
			bg_tags = N'',
			bg_project = 6,
			bg_org = 10,
			bg_category = 4,
			bg_priority = 0,
			bg_assigned_to_user = 0,
			bg_status = 18,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'Select',
bg_project_custom_dropdown_value2 = N'v61035',
bg_project_custom_dropdown_value3 = N'Select'
	
			
			where bg_id = 27
		end
		select @now
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 27

delete from bug_subscriptions
where bs_bug = 27
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 27
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 27
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 27, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 27
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 27)

insert into bug_subscriptions (bs_bug, bs_user)
select 27, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 27)

insert into bug_subscriptions (bs_bug, bs_user)
select 27, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 27
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 27)

insert into bug_subscriptions (bs_bug, bs_user)
select 27, us_id
from users
inner join bugs on bg_id = 27
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 27)
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 sql=
select count(1) from bug_subscriptions where bs_bug = 27 and bs_user = 1
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(27, 1, getdate(), N'changed status from "New" to "Hold"', 'update')
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (2 <= us_reported_notifications and bg_reported_user = bs_user)
or (2 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (2 <= us_assigned_notifications and 0 = bs_user)
or (2 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 27
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2018-09-24 11:39:04  started updating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 11:39:04  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 11:39:04  elapsed milliseconds:0000
2018-09-24 11:39:04  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 27
2018-09-24 11:39:04  elapsed milliseconds:0000
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 elapsed milliseconds:0008
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 27
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 elapsed milliseconds:0000
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 6
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 elapsed milliseconds:0000
2018-09-24 11:39:04  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 27
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 6
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 6
2018-09-24 11:39:04  elapsed milliseconds:0001
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 elapsed milliseconds:0000
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 27
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:39:04 http://192.168.0.31/edit_bug.aspx?id=27 elapsed milliseconds:0000
2018-09-24 11:39:04  done updating Lucene index
2018-09-24 11:39:06 http://192.168.0.31/edit_bug.aspx?id=26 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:39:06 http://192.168.0.31/edit_bug.aspx?id=26 elapsed milliseconds:0000
2018-09-24 11:39:06 http://192.168.0.31/edit_bug.aspx?id=26 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 26
2018-09-24 11:39:06 http://192.168.0.31/edit_bug.aspx?id=26 elapsed milliseconds:0014
2018-09-24 11:39:06 http://192.168.0.31/edit_bug.aspx?id=26 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2018-09-24 11:39:06 http://192.168.0.31/edit_bug.aspx?id=26 elapsed milliseconds:0000
2018-09-24 11:39:06 http://192.168.0.31/edit_bug.aspx?id=26 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 6
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:39:06 http://192.168.0.31/edit_bug.aspx?id=26 elapsed milliseconds:0000
2018-09-24 11:39:06 http://192.168.0.31/edit_bug.aspx?id=26 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 6
2018-09-24 11:39:06 http://192.168.0.31/edit_bug.aspx?id=26 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 6
2018-09-24 11:39:06 http://192.168.0.31/edit_bug.aspx?id=26 elapsed milliseconds:0000
2018-09-24 11:39:06 http://192.168.0.31/edit_bug.aspx?id=26 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 26
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:39:06 http://192.168.0.31/edit_bug.aspx?id=26 elapsed milliseconds:0004
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 elapsed milliseconds:0000
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 26
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 elapsed milliseconds:0000
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 6
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 26
		if @last_updated > '20180924 11:39:06:047'
		begin
			-- signal that we did NOT do the update
			set @now = '20180924 11:39:06:047'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'Assign Device',
			bg_tags = N'',
			bg_project = 6,
			bg_org = 10,
			bg_category = 2,
			bg_priority = 0,
			bg_assigned_to_user = 0,
			bg_status = 19,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'Select',
bg_project_custom_dropdown_value2 = N'Select',
bg_project_custom_dropdown_value3 = N'v61040'
	
			
			where bg_id = 26
		end
		select @now
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 26

delete from bug_subscriptions
where bs_bug = 26
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 26
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 26
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 26, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 26
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 26)

insert into bug_subscriptions (bs_bug, bs_user)
select 26, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 26)

insert into bug_subscriptions (bs_bug, bs_user)
select 26, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 26
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 26)

insert into bug_subscriptions (bs_bug, bs_user)
select 26, us_id
from users
inner join bugs on bg_id = 26
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 26)
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 sql=
select count(1) from bug_subscriptions where bs_bug = 26 and bs_user = 1
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(26, 1, getdate(), N'changed status from "New" to "Closed"', 'update')
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (2 <= us_reported_notifications and bg_reported_user = bs_user)
or (2 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (2 <= us_assigned_notifications and 0 = bs_user)
or (2 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 26
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2018-09-24 11:39:09  started updating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 11:39:09  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 11:39:09  elapsed milliseconds:0000
2018-09-24 11:39:09  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 26
2018-09-24 11:39:09  elapsed milliseconds:0000
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 elapsed milliseconds:0008
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 26
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 elapsed milliseconds:0000
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 6
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 elapsed milliseconds:0000
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 6
2018-09-24 11:39:09  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 26
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 6
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 elapsed milliseconds:0000
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 26
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:39:09  elapsed milliseconds:0001
2018-09-24 11:39:09 http://192.168.0.31/edit_bug.aspx?id=26 elapsed milliseconds:0000
2018-09-24 11:39:09  done updating Lucene index
2018-09-24 11:39:12 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:39:12 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:39:12 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:39:12 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:39:12 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 11
2018-09-24 11:39:12 http://192.168.0.31/bugs.aspx sql=
select bg_id ,bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc],
 isnull(pj_name,'') [project], 
isnull(bg_project_custom_dropdown_value1,'') [Version],
 isnull(og_name,'') [organization],
 isnull(ct_name,'') [category], 
rpt.us_username [reported by],
 bg_reported_date [reported on],  
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Programing Completed','QC Completed','Re-Open','Ready to deploy','Hold') then  'In-Process' else st_name end,'')[status],
 bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
-- left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:39:12 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:39:19 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:39:19 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:39:19 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2018-09-24 11:39:19 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:39:19 http://192.168.0.31/bugs.aspx elapsed milliseconds:0020
2018-09-24 11:39:32 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:39:32 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:39:32 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 11
2018-09-24 11:39:32 http://192.168.0.31/bugs.aspx sql=
select bg_id ,bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc],
 isnull(pj_name,'') [project], 
isnull(bg_project_custom_dropdown_value1,'') [Version],
 isnull(og_name,'') [organization],
 isnull(ct_name,'') [category], 
rpt.us_username [reported by],
 bg_reported_date [reported on],  
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Programing Completed','QC Completed','Re-Open','Ready to deploy','Hold') then  'In-Process' else st_name end,'')[status],
 bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
-- left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:39:32 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:39:40 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:39:40 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:39:40 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 16
2018-09-24 11:39:40 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status], 
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected', 'Ready to deploy','Hold') then 'New' else st_name end,'')[status], 
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc 
2018-09-24 11:39:40 http://192.168.0.31/bugs.aspx elapsed milliseconds:0012
2018-09-24 11:40:10 http://192.168.0.31/ajax.aspx?bugid=33 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:40:10 http://192.168.0.31/ajax.aspx?bugid=33 elapsed milliseconds:0001
2018-09-24 11:40:10 http://192.168.0.31/ajax.aspx?bugid=33 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 33
2018-09-24 11:40:10 http://192.168.0.31/ajax.aspx?bugid=33 elapsed milliseconds:0006
2018-09-24 11:40:10 http://192.168.0.31/ajax.aspx?bugid=33 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 33
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:40:10 http://192.168.0.31/ajax.aspx?bugid=33 elapsed milliseconds:0000
2018-09-24 11:40:10 http://192.168.0.31/ajax.aspx?bugid=32 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:40:10 http://192.168.0.31/ajax.aspx?bugid=32 elapsed milliseconds:0000
2018-09-24 11:40:10 http://192.168.0.31/ajax.aspx?bugid=32 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 32
2018-09-24 11:40:10 http://192.168.0.31/ajax.aspx?bugid=32 elapsed milliseconds:0001
2018-09-24 11:40:10 http://192.168.0.31/ajax.aspx?bugid=32 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 32
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:40:10 http://192.168.0.31/ajax.aspx?bugid=32 elapsed milliseconds:0000
2018-09-24 11:40:11 http://192.168.0.31/ajax.aspx?bugid=31 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:40:11 http://192.168.0.31/ajax.aspx?bugid=31 elapsed milliseconds:0000
2018-09-24 11:40:11 http://192.168.0.31/ajax.aspx?bugid=31 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 31
2018-09-24 11:40:11 http://192.168.0.31/ajax.aspx?bugid=31 elapsed milliseconds:0003
2018-09-24 11:40:11 http://192.168.0.31/ajax.aspx?bugid=31 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 31
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:40:11 http://192.168.0.31/ajax.aspx?bugid=31 elapsed milliseconds:0000
2018-09-24 11:40:11 http://192.168.0.31/edit_bug.aspx?id=31 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:40:11 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:40:11 http://192.168.0.31/edit_bug.aspx?id=31 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 31
2018-09-24 11:40:11 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:40:11 http://192.168.0.31/edit_bug.aspx?id=31 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2018-09-24 11:40:11 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:40:11 http://192.168.0.31/edit_bug.aspx?id=31 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 3
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 11:40:11 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:40:11 http://192.168.0.31/edit_bug.aspx?id=31 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 3
2018-09-24 11:40:11 http://192.168.0.31/edit_bug.aspx?id=31 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 3
2018-09-24 11:40:11 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:40:11 http://192.168.0.31/edit_bug.aspx?id=31 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 31
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:40:11 http://192.168.0.31/edit_bug.aspx?id=31 elapsed milliseconds:0000
2018-09-24 11:40:26 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:40:26 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:40:26 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:40:26 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:40:26 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 16
2018-09-24 11:40:26 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status], 
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected', 'Ready to deploy','Hold') then 'New' else st_name end,'')[status], 
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc 
2018-09-24 11:40:26 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:40:29 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:40:29 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:40:29 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 18
2018-09-24 11:40:29 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','open','In-process','Programming Completed','QC Completed','Re-Open','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:40:29 http://192.168.0.31/bugs.aspx elapsed milliseconds:0012
2018-09-24 11:40:55 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '563b8fb5-2324-4870-a63b-4d355f95e775'
and us_active = 1
2018-09-24 11:40:55 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:40:55 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 11
2018-09-24 11:40:55 http://192.168.0.31/bugs.aspx sql=
select bg_id ,bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc],
 isnull(pj_name,'') [project], 
isnull(bg_project_custom_dropdown_value1,'') [Version],
 isnull(og_name,'') [organization],
 isnull(ct_name,'') [category], 
rpt.us_username [reported by],
 bg_reported_date [reported on],  
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Programing Completed','QC Completed','Re-Open','Ready to deploy','Hold') then  'In-Process' else st_name end,'')[status],
 bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
-- left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:40:55 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:41:00 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'563b8fb5-2324-4870-a63b-4d355f95e775'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 11:41:00 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:41:07 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:41:07 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'care1'
2018-09-24 11:41:07 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0001
2018-09-24 11:41:07 http://192.168.0.31/default.aspx?msg=logged+off Unknown user care1 attempted to login.
2018-09-24 11:41:15 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:41:15 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'careuser1'
2018-09-24 11:41:15 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0002
2018-09-24 11:41:15 http://192.168.0.31/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 11
2018-09-24 11:41:15 http://192.168.0.31/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'careuser1'
2018-09-24 11:41:15 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0001
2018-09-24 11:41:15 http://192.168.0.31/default.aspx?msg=logged+off guid=680cf560-804f-4289-ab30-7580c371052e
2018-09-24 11:41:15 http://192.168.0.31/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('680cf560-804f-4289-ab30-7580c371052e', 11)
2018-09-24 11:41:15 http://192.168.0.31/default.aspx?msg=logged+off AppPath:
2018-09-24 11:41:15 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '680cf560-804f-4289-ab30-7580c371052e';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '680cf560-804f-4289-ab30-7580c371052e'
and us_active = 1
2018-09-24 11:41:15 http://192.168.0.31/bugs.aspx elapsed milliseconds:0015
2018-09-24 11:41:15 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 11
or isnull(qu_org,0) = 10
order by qu_desc
2018-09-24 11:41:15 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:41:15 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 11)
2018-09-24 11:41:15 http://192.168.0.31/bugs.aspx elapsed milliseconds:0002
2018-09-24 11:41:15 http://192.168.0.31/bugs.aspx sql=
select bg_id ,bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc],
 isnull(pj_name,'') [project], 
isnull(bg_project_custom_dropdown_value1,'') [Version],
 isnull(og_name,'') [organization],
 isnull(ct_name,'') [category], 
rpt.us_username [reported by],
 bg_reported_date [reported on],  
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Programing Completed','QC Completed','Re-Open','Ready to deploy','Hold') then  'In-Process' else st_name end,'')[status],
 bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 11 
 left outer join users rpt on rpt.us_id = bg_reported_user
-- left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 11
					and pu_permission_level = 0)) 
					    and bugs.bg_org = 10 order by bg_id desc
2018-09-24 11:41:15 http://192.168.0.31/bugs.aspx elapsed milliseconds:0015
2018-09-24 11:41:22 http://192.168.0.31/ajax.aspx?bugid=27 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '680cf560-804f-4289-ab30-7580c371052e';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '680cf560-804f-4289-ab30-7580c371052e'
and us_active = 1
2018-09-24 11:41:22 http://192.168.0.31/ajax.aspx?bugid=27 elapsed milliseconds:0001
2018-09-24 11:41:22 http://192.168.0.31/ajax.aspx?bugid=27 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 11
where bg_id = 27
2018-09-24 11:41:22 http://192.168.0.31/ajax.aspx?bugid=27 elapsed milliseconds:0005
2018-09-24 11:41:22 http://192.168.0.31/ajax.aspx?bugid=27 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 27
and a.bp_parent is null
 and a.bp_type <> 'update'
 and a.bp_hidden_from_external_users = 0
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:41:22 http://192.168.0.31/ajax.aspx?bugid=27 elapsed milliseconds:0015
2018-09-24 11:41:22 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '680cf560-804f-4289-ab30-7580c371052e';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '680cf560-804f-4289-ab30-7580c371052e'
and us_active = 1
2018-09-24 11:41:22 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:41:27 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '680cf560-804f-4289-ab30-7580c371052e';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '680cf560-804f-4289-ab30-7580c371052e'
and us_active = 1
2018-09-24 11:41:27 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:41:31 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '680cf560-804f-4289-ab30-7580c371052e';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '680cf560-804f-4289-ab30-7580c371052e'
and us_active = 1
2018-09-24 11:41:31 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:41:31 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 2
2018-09-24 11:41:31 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project],isnull(bg_project_custom_dropdown_value1,'') [Version],
  isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 11 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
 where /* altered - both  */ (  bg_status <> 5  ) AND (  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 11
					and pu_permission_level = 0)) 
					    and bugs.bg_org = 10  ) order by bg_id desc
2018-09-24 11:41:31 http://192.168.0.31/bugs.aspx elapsed milliseconds:0026
2018-09-24 11:41:33 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '680cf560-804f-4289-ab30-7580c371052e';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '680cf560-804f-4289-ab30-7580c371052e'
and us_active = 1
2018-09-24 11:41:33 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:41:33 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 11
2018-09-24 11:41:33 http://192.168.0.31/bugs.aspx sql=
select bg_id ,bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc],
 isnull(pj_name,'') [project], 
isnull(bg_project_custom_dropdown_value1,'') [Version],
 isnull(og_name,'') [organization],
 isnull(ct_name,'') [category], 
rpt.us_username [reported by],
 bg_reported_date [reported on],  
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Programing Completed','QC Completed','Re-Open','Ready to deploy','Hold') then  'In-Process' else st_name end,'')[status],
 bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 11 
 left outer join users rpt on rpt.us_id = bg_reported_user
-- left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 11
					and pu_permission_level = 0)) 
					    and bugs.bg_org = 10 order by bg_id desc
2018-09-24 11:41:33 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:41:35 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'680cf560-804f-4289-ab30-7580c371052e'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 11:41:35 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:41:39 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:41:39 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'dev1'
2018-09-24 11:41:39 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0003
2018-09-24 11:41:39 http://192.168.0.31/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 2
2018-09-24 11:41:39 http://192.168.0.31/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'dev1'
2018-09-24 11:41:39 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:41:39 http://192.168.0.31/default.aspx?msg=logged+off guid=91742049-9a8b-4458-95ab-e1f3021c1be7
2018-09-24 11:41:39 http://192.168.0.31/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('91742049-9a8b-4458-95ab-e1f3021c1be7', 2)
2018-09-24 11:41:39 http://192.168.0.31/default.aspx?msg=logged+off AppPath:
2018-09-24 11:41:39 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '91742049-9a8b-4458-95ab-e1f3021c1be7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '91742049-9a8b-4458-95ab-e1f3021c1be7'
and us_active = 1
2018-09-24 11:41:39 http://192.168.0.31/bugs.aspx elapsed milliseconds:0009
2018-09-24 11:41:39 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 2
or isnull(qu_org,0) = 2
order by qu_desc
2018-09-24 11:41:39 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:41:39 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 2)
2018-09-24 11:41:39 http://192.168.0.31/bugs.aspx elapsed milliseconds:0002
2018-09-24 11:41:39 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected', 'Ready to deploy','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 2 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 2
					and pu_permission_level = 0)) order by bg_id desc

2018-09-24 11:41:39 http://192.168.0.31/bugs.aspx elapsed milliseconds:0021
2018-09-24 11:41:47 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'91742049-9a8b-4458-95ab-e1f3021c1be7'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 11:41:47 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:41:53 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:41:53 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'qa1'
2018-09-24 11:41:53 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0002
2018-09-24 11:41:53 http://192.168.0.31/default.aspx?msg=logged+off Unknown user qa1 attempted to login.
2018-09-24 11:41:56 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:41:56 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'qa1'
2018-09-24 11:41:56 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:41:56 http://192.168.0.31/default.aspx?msg=logged+off Unknown user qa1 attempted to login.
2018-09-24 11:42:02 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:42:02 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'qa'
2018-09-24 11:42:02 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0002
2018-09-24 11:42:02 http://192.168.0.31/default.aspx?msg=logged+off Unknown user qa attempted to login.
2018-09-24 11:42:15 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:42:15 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'dep1'
2018-09-24 11:42:15 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0001
2018-09-24 11:42:15 http://192.168.0.31/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 15
2018-09-24 11:42:15 http://192.168.0.31/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'dep1'
2018-09-24 11:42:15 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:42:15 http://192.168.0.31/default.aspx?msg=logged+off guid=6b8a2274-a6d6-4cfd-a6d3-f89167b919ef
2018-09-24 11:42:15 http://192.168.0.31/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('6b8a2274-a6d6-4cfd-a6d3-f89167b919ef', 15)
2018-09-24 11:42:15 http://192.168.0.31/default.aspx?msg=logged+off AppPath:
2018-09-24 11:42:15 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '6b8a2274-a6d6-4cfd-a6d3-f89167b919ef';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '6b8a2274-a6d6-4cfd-a6d3-f89167b919ef'
and us_active = 1
2018-09-24 11:42:15 http://192.168.0.31/bugs.aspx elapsed milliseconds:0012
2018-09-24 11:42:15 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 15
or isnull(qu_org,0) = 6
order by qu_desc
2018-09-24 11:42:15 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:42:15 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 15)
2018-09-24 11:42:15 http://192.168.0.31/bugs.aspx elapsed milliseconds:0002
2018-09-24 11:42:15 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','open','In-process','Programming Completed','QC Completed','Re-Open','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 15 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 15
					and pu_permission_level = 0)) order by bg_id desc

2018-09-24 11:42:15 http://192.168.0.31/bugs.aspx elapsed milliseconds:0015
2018-09-24 11:42:24 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'6b8a2274-a6d6-4cfd-a6d3-f89167b919ef'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 11:42:24 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:42:28 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:42:28 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2018-09-24 11:42:28 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0003
2018-09-24 11:42:28 http://192.168.0.31/default.aspx?msg=logged+off User admin entered an incorrect password.
2018-09-24 11:42:32 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:42:32 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2018-09-24 11:42:32 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:42:32 http://192.168.0.31/default.aspx?msg=logged+off failed attempt count for admin:1
2018-09-24 11:42:32 http://192.168.0.31/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2018-09-24 11:42:32 http://192.168.0.31/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'admin'
2018-09-24 11:42:32 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:42:32 http://192.168.0.31/default.aspx?msg=logged+off guid=9e5b2875-a319-462f-ab05-889ac70b3d0d
2018-09-24 11:42:32 http://192.168.0.31/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('9e5b2875-a319-462f-ab05-889ac70b3d0d', 1)
2018-09-24 11:42:32 http://192.168.0.31/default.aspx?msg=logged+off AppPath:
2018-09-24 11:42:32 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '9e5b2875-a319-462f-ab05-889ac70b3d0d';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '9e5b2875-a319-462f-ab05-889ac70b3d0d'
and us_active = 1
2018-09-24 11:42:32 http://192.168.0.31/bugs.aspx elapsed milliseconds:0012
2018-09-24 11:42:32 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:42:32 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:42:32 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2018-09-24 11:42:32 http://192.168.0.31/bugs.aspx elapsed milliseconds:0003
2018-09-24 11:42:32 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:42:32 http://192.168.0.31/bugs.aspx elapsed milliseconds:0002
2018-09-24 11:42:35 http://192.168.0.31/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '9e5b2875-a319-462f-ab05-889ac70b3d0d';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '9e5b2875-a319-462f-ab05-889ac70b3d0d'
and us_active = 1
2018-09-24 11:42:35 http://192.168.0.31/admin.aspx elapsed milliseconds:0000
2018-09-24 11:42:35 http://192.168.0.31/admin.aspx sql=
select count(1) from bugs
2018-09-24 11:42:36 http://192.168.0.31/users.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '9e5b2875-a319-462f-ab05-889ac70b3d0d';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '9e5b2875-a319-462f-ab05-889ac70b3d0d'
and us_active = 1
2018-09-24 11:42:36 http://192.168.0.31/users.aspx elapsed milliseconds:0000
2018-09-24 11:42:36 http://192.168.0.31/users.aspx sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2018-09-24 11:42:36 http://192.168.0.31/users.aspx elapsed milliseconds:0159
2018-09-24 11:42:42 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'9e5b2875-a319-462f-ab05-889ac70b3d0d'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 11:42:42 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:42:46 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:42:46 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'qc1'
2018-09-24 11:42:46 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:42:46 http://192.168.0.31/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 3
2018-09-24 11:42:46 http://192.168.0.31/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'qc1'
2018-09-24 11:42:46 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:42:46 http://192.168.0.31/default.aspx?msg=logged+off guid=7515e404-2c36-4578-8979-7a3f1deced5b
2018-09-24 11:42:46 http://192.168.0.31/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('7515e404-2c36-4578-8979-7a3f1deced5b', 3)
2018-09-24 11:42:46 http://192.168.0.31/default.aspx?msg=logged+off AppPath:
2018-09-24 11:42:46 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '7515e404-2c36-4578-8979-7a3f1deced5b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '7515e404-2c36-4578-8979-7a3f1deced5b'
and us_active = 1
2018-09-24 11:42:46 http://192.168.0.31/bugs.aspx elapsed milliseconds:0005
2018-09-24 11:42:46 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 3
or isnull(qu_org,0) = 7
order by qu_desc
2018-09-24 11:42:46 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:42:46 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 3)
2018-09-24 11:42:46 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:42:46 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
--isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','Open','In-Process','Ready to deploy','Hold') then  'New' else st_name end,'')[status],

 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
 where /* altered - both  */ (  bg_status = 3  ) AND (  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0))  ) order by bg_id desc

2018-09-24 11:42:46 http://192.168.0.31/bugs.aspx elapsed milliseconds:0010
2018-09-24 11:42:53 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '7515e404-2c36-4578-8979-7a3f1deced5b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '7515e404-2c36-4578-8979-7a3f1deced5b'
and us_active = 1
2018-09-24 11:42:53 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:42:53 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 11
2018-09-24 11:42:53 http://192.168.0.31/bugs.aspx sql=
select bg_id ,bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc],
 isnull(pj_name,'') [project], 
isnull(bg_project_custom_dropdown_value1,'') [Version],
 isnull(og_name,'') [organization],
 isnull(ct_name,'') [category], 
rpt.us_username [reported by],
 bg_reported_date [reported on],  
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Programing Completed','QC Completed','Re-Open','Ready to deploy','Hold') then  'In-Process' else st_name end,'')[status],
 bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user
-- left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:42:53 http://192.168.0.31/bugs.aspx elapsed milliseconds:0042
2018-09-24 11:42:59 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '7515e404-2c36-4578-8979-7a3f1deced5b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '7515e404-2c36-4578-8979-7a3f1deced5b'
and us_active = 1
2018-09-24 11:42:59 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:42:59 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 2
2018-09-24 11:42:59 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project],isnull(bg_project_custom_dropdown_value1,'') [Version],
  isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
 where /* altered - both  */ (  bg_status <> 5  ) AND (  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0))  ) order by bg_id desc
2018-09-24 11:42:59 http://192.168.0.31/bugs.aspx elapsed milliseconds:0039
2018-09-24 11:43:01 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '7515e404-2c36-4578-8979-7a3f1deced5b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '7515e404-2c36-4578-8979-7a3f1deced5b'
and us_active = 1
2018-09-24 11:43:01 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:43:01 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 4
2018-09-24 11:43:01 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
--isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','Open','In-Process','Ready to deploy','Hold') then  'New' else st_name end,'')[status],

 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
 where /* altered - both  */ (  bg_status = 3  ) AND (  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0))  ) order by bg_id desc

2018-09-24 11:43:01 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:43:03 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '7515e404-2c36-4578-8979-7a3f1deced5b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '7515e404-2c36-4578-8979-7a3f1deced5b'
and us_active = 1
2018-09-24 11:43:03 http://192.168.0.31/queries.aspx elapsed milliseconds:0000
2018-09-24 11:43:03 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>rename</a>' [rename],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete]
			from queries
			inner join users on qu_user = us_id
			where isnull(qu_user,0) = 3
			order by qu_desc
2018-09-24 11:43:03 http://192.168.0.31/queries.aspx elapsed milliseconds:0003
2018-09-24 11:43:06 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'7515e404-2c36-4578-8979-7a3f1deced5b'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 11:43:06 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:43:10 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:43:10 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2018-09-24 11:43:10 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:43:10 http://192.168.0.31/default.aspx?msg=logged+off failed attempt count for admin:0
2018-09-24 11:43:10 http://192.168.0.31/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2018-09-24 11:43:10 http://192.168.0.31/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'admin'
2018-09-24 11:43:10 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:43:10 http://192.168.0.31/default.aspx?msg=logged+off guid=89f605c4-a993-4073-8fbd-544eff335582
2018-09-24 11:43:10 http://192.168.0.31/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('89f605c4-a993-4073-8fbd-544eff335582', 1)
2018-09-24 11:43:10 http://192.168.0.31/default.aspx?msg=logged+off AppPath:
2018-09-24 11:43:10 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:43:10 http://192.168.0.31/bugs.aspx elapsed milliseconds:0006
2018-09-24 11:43:10 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:43:10 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:43:10 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2018-09-24 11:43:10 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:43:10 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:43:10 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:43:11 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:43:11 http://192.168.0.31/queries.aspx elapsed milliseconds:0000
2018-09-24 11:43:11 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:43:11 http://192.168.0.31/queries.aspx elapsed milliseconds:0005
2018-09-24 11:43:19 http://192.168.0.31/edit_query.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:43:19 http://192.168.0.31/edit_query.aspx?id=4 elapsed milliseconds:0000
2018-09-24 11:43:19 http://192.168.0.31/edit_query.aspx?id=4 sql=
/* populate org/user dropdowns */
select og_id, og_name from orgs order by og_name;
select us_id, us_username from users order by us_username
2018-09-24 11:43:19 http://192.168.0.31/edit_query.aspx?id=4 elapsed milliseconds:0001
2018-09-24 11:43:19 http://192.168.0.31/edit_query.aspx?id=4 sql=
select
				qu_desc, qu_sql, isnull(qu_user,0) [qu_user], isnull(qu_org,0) [qu_org]
				from queries where qu_id = 4
2018-09-24 11:43:19 http://192.168.0.31/edit_query.aspx?id=4 elapsed milliseconds:0001
2018-09-24 11:44:46 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:44:46 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:44:46 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:44:46 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:44:46 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2018-09-24 11:44:46 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:44:46 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:44:51 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:44:51 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:44:51 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 17
2018-09-24 11:44:51 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
--isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','Open','In-Process','Ready to deploy','Hold') then  'New' else st_name end,'')[status],

 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
 where /* altered - both  */ (  bg_status = 3  ) AND (  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0))  ) order by bg_id desc
2018-09-24 11:44:51 http://192.168.0.31/bugs.aspx elapsed milliseconds:0013
2018-09-24 11:44:59 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:44:59 http://192.168.0.31/queries.aspx elapsed milliseconds:0000
2018-09-24 11:44:59 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:44:59 http://192.168.0.31/queries.aspx elapsed milliseconds:0001
2018-09-24 11:45:03 http://192.168.0.31/edit_query.aspx?id=17 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:45:03 http://192.168.0.31/edit_query.aspx?id=17 elapsed milliseconds:0000
2018-09-24 11:45:03 http://192.168.0.31/edit_query.aspx?id=17 sql=
/* populate org/user dropdowns */
select og_id, og_name from orgs order by og_name;
select us_id, us_username from users order by us_username
2018-09-24 11:45:03 http://192.168.0.31/edit_query.aspx?id=17 elapsed milliseconds:0000
2018-09-24 11:45:03 http://192.168.0.31/edit_query.aspx?id=17 sql=
select
				qu_desc, qu_sql, isnull(qu_user,0) [qu_user], isnull(qu_org,0) [qu_org]
				from queries where qu_id = 17
2018-09-24 11:45:03 http://192.168.0.31/edit_query.aspx?id=17 elapsed milliseconds:0000
2018-09-24 11:45:14 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:45:14 http://192.168.0.31/queries.aspx elapsed milliseconds:0000
2018-09-24 11:45:14 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:45:14 http://192.168.0.31/queries.aspx elapsed milliseconds:0001
2018-09-24 11:45:23 http://192.168.0.31/edit_query.aspx?id=16 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:45:23 http://192.168.0.31/edit_query.aspx?id=16 elapsed milliseconds:0000
2018-09-24 11:45:23 http://192.168.0.31/edit_query.aspx?id=16 sql=
/* populate org/user dropdowns */
select og_id, og_name from orgs order by og_name;
select us_id, us_username from users order by us_username
2018-09-24 11:45:23 http://192.168.0.31/edit_query.aspx?id=16 elapsed milliseconds:0000
2018-09-24 11:45:23 http://192.168.0.31/edit_query.aspx?id=16 sql=
select
				qu_desc, qu_sql, isnull(qu_user,0) [qu_user], isnull(qu_org,0) [qu_org]
				from queries where qu_id = 16
2018-09-24 11:45:23 http://192.168.0.31/edit_query.aspx?id=16 elapsed milliseconds:0000
2018-09-24 11:46:27 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:46:27 http://192.168.0.31/queries.aspx elapsed milliseconds:0000
2018-09-24 11:46:27 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:46:27 http://192.168.0.31/queries.aspx elapsed milliseconds:0001
2018-09-24 11:46:30 http://192.168.0.31/edit_query.aspx?id=17 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:46:30 http://192.168.0.31/edit_query.aspx?id=17 elapsed milliseconds:0000
2018-09-24 11:46:30 http://192.168.0.31/edit_query.aspx?id=17 sql=
/* populate org/user dropdowns */
select og_id, og_name from orgs order by og_name;
select us_id, us_username from users order by us_username
2018-09-24 11:46:30 http://192.168.0.31/edit_query.aspx?id=17 elapsed milliseconds:0000
2018-09-24 11:46:30 http://192.168.0.31/edit_query.aspx?id=17 sql=
select
				qu_desc, qu_sql, isnull(qu_user,0) [qu_user], isnull(qu_org,0) [qu_org]
				from queries where qu_id = 17
2018-09-24 11:46:30 http://192.168.0.31/edit_query.aspx?id=17 elapsed milliseconds:0000
2018-09-24 11:46:34 http://192.168.0.31/edit_query.aspx?id=17 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:46:34 http://192.168.0.31/edit_query.aspx?id=17 elapsed milliseconds:0000
2018-09-24 11:46:34 http://192.168.0.31/edit_query.aspx?id=17 sql=
select count(1) from queries where qu_desc = N'QC view' and qu_id <> 17
2018-09-24 11:46:34 http://192.168.0.31/edit_query.aspx?id=17 sql=
update queries set
				qu_desc = N'QC view',
				qu_sql = N'select isnull(pr_background_color,''#ffffff''), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'''') [project], isnull(bg_project_custom_dropdown_value1,'''') [Version], isnull(og_name,'''') [organization], isnull(ct_name,'''') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'''') [priority], isnull(asg.us_username,'''') [assigned to], 
 --isnull(st_name,'''') [status], 
  isnull(case when st_name IN(''Waiting for approval'',''Approved'',''Rejected'',''Open'',''In-Process'',''Ready to deploy'',''Hold'') then  ''New'' else st_name end,'''')[status],
 isnull(lu.us_username,'''') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = $ME 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
 order by bg_id desc ',
				qu_user = 0,
				qu_org = 1
				where qu_id = 17
2018-09-24 11:46:34 http://192.168.0.31/edit_query.aspx?id=17 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:46:34 http://192.168.0.31/edit_query.aspx?id=17 elapsed milliseconds:0000
2018-09-24 11:46:34 http://192.168.0.31/edit_query.aspx?id=17 sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:46:34 http://192.168.0.31/edit_query.aspx?id=17 elapsed milliseconds:0001
2018-09-24 11:46:36 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:46:36 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:46:36 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:46:36 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:46:36 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 17
2018-09-24 11:46:36 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status], 
  isnull(case when st_name IN('Waiting for approval','Approved','Rejected','Open','In-Process','Ready to deploy','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc 
2018-09-24 11:46:36 http://192.168.0.31/bugs.aspx elapsed milliseconds:0012
2018-09-24 11:47:13 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:47:13 http://192.168.0.31/queries.aspx elapsed milliseconds:0000
2018-09-24 11:47:13 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:47:13 http://192.168.0.31/queries.aspx elapsed milliseconds:0001
2018-09-24 11:47:17 http://192.168.0.31/edit_query.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:47:17 http://192.168.0.31/edit_query.aspx?id=4 elapsed milliseconds:0000
2018-09-24 11:47:17 http://192.168.0.31/edit_query.aspx?id=4 sql=
/* populate org/user dropdowns */
select og_id, og_name from orgs order by og_name;
select us_id, us_username from users order by us_username
2018-09-24 11:47:17 http://192.168.0.31/edit_query.aspx?id=4 elapsed milliseconds:0000
2018-09-24 11:47:17 http://192.168.0.31/edit_query.aspx?id=4 sql=
select
				qu_desc, qu_sql, isnull(qu_user,0) [qu_user], isnull(qu_org,0) [qu_org]
				from queries where qu_id = 4
2018-09-24 11:47:17 http://192.168.0.31/edit_query.aspx?id=4 elapsed milliseconds:0000
2018-09-24 11:47:23 http://192.168.0.31/edit_query.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:47:23 http://192.168.0.31/edit_query.aspx?id=4 elapsed milliseconds:0000
2018-09-24 11:47:23 http://192.168.0.31/edit_query.aspx?id=4 sql=
select count(1) from queries where qu_desc = N'checked in bugs - for QA' and qu_id <> 4
2018-09-24 11:47:23 http://192.168.0.31/edit_query.aspx?id=4 sql=
update queries set
				qu_desc = N'checked in bugs - for QA',
				qu_sql = N'select isnull(pr_background_color,''#ffffff''), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'''') [project], isnull(bg_project_custom_dropdown_value1,'''') [Version], isnull(og_name,'''') [organization], isnull(ct_name,'''') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'''') [priority], isnull(asg.us_username,'''') [assigned to], 
 --isnull(st_name,'''') [status], 
  isnull(case when st_name IN(''Waiting for approval'',''Approved'',''Rejected'',''Open'',''In-Process'',''Ready to deploy'',''Hold'') then  ''New'' else st_name end,'''')[status],
 isnull(lu.us_username,'''') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = $ME 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
 order by bg_id desc ',
				qu_user = 0,
				qu_org = 7
				where qu_id = 4
2018-09-24 11:47:23 http://192.168.0.31/edit_query.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '89f605c4-a993-4073-8fbd-544eff335582';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '89f605c4-a993-4073-8fbd-544eff335582'
and us_active = 1
2018-09-24 11:47:23 http://192.168.0.31/edit_query.aspx?id=4 elapsed milliseconds:0000
2018-09-24 11:47:23 http://192.168.0.31/edit_query.aspx?id=4 sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:47:23 http://192.168.0.31/edit_query.aspx?id=4 elapsed milliseconds:0001
2018-09-24 11:47:29 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'89f605c4-a993-4073-8fbd-544eff335582'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 11:47:29 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:47:39 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:47:39 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'qc1'
2018-09-24 11:47:39 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:47:39 http://192.168.0.31/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 3
2018-09-24 11:47:39 http://192.168.0.31/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'qc1'
2018-09-24 11:47:39 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:47:39 http://192.168.0.31/default.aspx?msg=logged+off guid=8b6ad013-3946-44f8-9289-b6aba2ea007b
2018-09-24 11:47:39 http://192.168.0.31/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('8b6ad013-3946-44f8-9289-b6aba2ea007b', 3)
2018-09-24 11:47:39 http://192.168.0.31/default.aspx?msg=logged+off AppPath:
2018-09-24 11:47:39 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '8b6ad013-3946-44f8-9289-b6aba2ea007b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '8b6ad013-3946-44f8-9289-b6aba2ea007b'
and us_active = 1
2018-09-24 11:47:39 http://192.168.0.31/bugs.aspx elapsed milliseconds:0008
2018-09-24 11:47:39 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 3
or isnull(qu_org,0) = 7
order by qu_desc
2018-09-24 11:47:39 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:47:39 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 3)
2018-09-24 11:47:39 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:47:39 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status], 
  isnull(case when st_name IN('Waiting for approval','Approved','Rejected','Open','In-Process','Ready to deploy','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0)) order by bg_id desc 
2018-09-24 11:47:39 http://192.168.0.31/bugs.aspx elapsed milliseconds:0013
2018-09-24 11:47:48 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'8b6ad013-3946-44f8-9289-b6aba2ea007b'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 11:47:48 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:50:39 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:50:39 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2018-09-24 11:50:39 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:50:39 http://192.168.0.31/default.aspx?msg=logged+off failed attempt count for admin:0
2018-09-24 11:50:39 http://192.168.0.31/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2018-09-24 11:50:39 http://192.168.0.31/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'admin'
2018-09-24 11:50:39 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:50:39 http://192.168.0.31/default.aspx?msg=logged+off guid=cebfc307-1a74-4cf0-98bf-9f14915c06bc
2018-09-24 11:50:39 http://192.168.0.31/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('cebfc307-1a74-4cf0-98bf-9f14915c06bc', 1)
2018-09-24 11:50:39 http://192.168.0.31/default.aspx?msg=logged+off AppPath:
2018-09-24 11:50:39 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:50:39 http://192.168.0.31/bugs.aspx elapsed milliseconds:0005
2018-09-24 11:50:39 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:50:39 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:50:39 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2018-09-24 11:50:39 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:50:39 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:50:39 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:50:43 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:50:43 http://192.168.0.31/queries.aspx elapsed milliseconds:0000
2018-09-24 11:50:43 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:50:43 http://192.168.0.31/queries.aspx elapsed milliseconds:0001
2018-09-24 11:50:45 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:50:45 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:50:45 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:50:45 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:50:45 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2018-09-24 11:50:45 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:50:45 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:50:45 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:50:45 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:50:45 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:50:45 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:50:45 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2018-09-24 11:50:45 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:50:45 http://192.168.0.31/bugs.aspx elapsed milliseconds:0004
2018-09-24 11:50:47 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:50:47 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:50:47 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 17
2018-09-24 11:50:47 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status], 
  isnull(case when st_name IN('Waiting for approval','Approved','Rejected','Open','In-Process','Ready to deploy','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc 
2018-09-24 11:50:47 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:51:15 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:51:15 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:51:15 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 11
2018-09-24 11:51:15 http://192.168.0.31/bugs.aspx sql=
select bg_id ,bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc],
 isnull(pj_name,'') [project], 
isnull(bg_project_custom_dropdown_value1,'') [Version],
 isnull(og_name,'') [organization],
 isnull(ct_name,'') [category], 
rpt.us_username [reported by],
 bg_reported_date [reported on],  
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Programing Completed','QC Completed','Re-Open','Ready to deploy','Hold') then  'In-Process' else st_name end,'')[status],
 bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
-- left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:51:15 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:51:33 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:51:33 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:51:33 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 18
2018-09-24 11:51:33 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','open','In-process','Programming Completed','QC Completed','Re-Open','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:51:33 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:51:55 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:51:55 http://192.168.0.31/queries.aspx elapsed milliseconds:0000
2018-09-24 11:51:55 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:51:55 http://192.168.0.31/queries.aspx elapsed milliseconds:0002
2018-09-24 11:52:00 http://192.168.0.31/edit_query.aspx?id=13 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:52:00 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:52:00 http://192.168.0.31/edit_query.aspx?id=13 sql=
/* populate org/user dropdowns */
select og_id, og_name from orgs order by og_name;
select us_id, us_username from users order by us_username
2018-09-24 11:52:00 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:52:00 http://192.168.0.31/edit_query.aspx?id=13 sql=
select
				qu_desc, qu_sql, isnull(qu_user,0) [qu_user], isnull(qu_org,0) [qu_org]
				from queries where qu_id = 13
2018-09-24 11:52:00 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:52:19 http://192.168.0.31/edit_query.aspx?id=13 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:52:19 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:52:19 http://192.168.0.31/edit_query.aspx?id=13 sql=
select count(1) from queries where qu_desc = N'Deployment' and qu_id <> 13
2018-09-24 11:52:19 http://192.168.0.31/edit_query.aspx?id=13 sql=
update queries set
				qu_desc = N'Deployment',
				qu_sql = N'select isnull(pr_background_color,''#ffffff''), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'''') [project], isnull(bg_project_custom_dropdown_value1,'''') [Version], isnull(og_name,'''') [organization], isnull(ct_name,'''') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'''') [priority], isnull(asg.us_username,'''') [assigned to], 
 --isnull(st_name,'''') [status],
 isnull(case when st_name IN(''Waiting for approval'',''Approved'',''Rejected'',''open'',''In-process'',''Programming Completed'',''Re-Open'',''Hold'') then  ''New'' else st_name end,'''')[status],
 isnull(lu.us_username,'''') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = $ME 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
 order by bg_id desc
',
				qu_user = 0,
				qu_org = 6
				where qu_id = 13
2018-09-24 11:52:19 http://192.168.0.31/edit_query.aspx?id=13 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:52:19 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:52:19 http://192.168.0.31/edit_query.aspx?id=13 sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:52:19 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0001
2018-09-24 11:52:21 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:52:21 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:52:21 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:52:21 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:52:21 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 18
2018-09-24 11:52:21 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','open','In-process','Programming Completed','QC Completed','Re-Open','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:52:21 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:52:23 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:52:23 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:52:23 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:52:23 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:52:23 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 18
2018-09-24 11:52:23 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','open','In-process','Programming Completed','QC Completed','Re-Open','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:52:23 http://192.168.0.31/bugs.aspx elapsed milliseconds:0002
2018-09-24 11:52:26 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:52:26 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:52:26 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 5
2018-09-24 11:52:26 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_style + st_style,'datad'), bg_id [id], isnull(bu_flag,0) [$FLAG], bg_short_desc [desc], isnull(pr_name,'') [priority], isnull(st_name,'') [status]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:52:26 http://192.168.0.31/bugs.aspx elapsed milliseconds:0008
2018-09-24 11:52:28 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:52:28 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:52:28 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 18
2018-09-24 11:52:28 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','open','In-process','Programming Completed','QC Completed','Re-Open','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:52:28 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:52:35 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:52:35 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:52:35 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 17
2018-09-24 11:52:35 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status], 
  isnull(case when st_name IN('Waiting for approval','Approved','Rejected','Open','In-Process','Ready to deploy','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc 
2018-09-24 11:52:35 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:52:41 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:52:42 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:52:42 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 18
2018-09-24 11:52:42 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','open','In-process','Programming Completed','QC Completed','Re-Open','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:52:42 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:52:45 http://192.168.0.31/ajax.aspx?bugid=24 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:52:45 http://192.168.0.31/ajax.aspx?bugid=24 elapsed milliseconds:0001
2018-09-24 11:52:45 http://192.168.0.31/ajax.aspx?bugid=24 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 24
2018-09-24 11:52:45 http://192.168.0.31/ajax.aspx?bugid=24 elapsed milliseconds:0005
2018-09-24 11:52:45 http://192.168.0.31/ajax.aspx?bugid=24 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 24
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:52:45 http://192.168.0.31/ajax.aspx?bugid=24 elapsed milliseconds:0015
2018-09-24 11:52:47 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
and us_active = 1
2018-09-24 11:52:47 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:52:47 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:52:47 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:52:47 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 18
2018-09-24 11:52:47 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','open','In-process','Programming Completed','QC Completed','Re-Open','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:52:47 http://192.168.0.31/bugs.aspx elapsed milliseconds:0002
2018-09-24 11:52:48 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'cebfc307-1a74-4cf0-98bf-9f14915c06bc'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 11:52:48 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:52:51 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:52:51 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2018-09-24 11:52:51 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:52:51 http://192.168.0.31/default.aspx?msg=logged+off failed attempt count for admin:0
2018-09-24 11:52:51 http://192.168.0.31/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2018-09-24 11:52:51 http://192.168.0.31/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'admin'
2018-09-24 11:52:51 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:52:51 http://192.168.0.31/default.aspx?msg=logged+off guid=36078e6c-69c6-4612-ad23-54b964bc7828
2018-09-24 11:52:51 http://192.168.0.31/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('36078e6c-69c6-4612-ad23-54b964bc7828', 1)
2018-09-24 11:52:51 http://192.168.0.31/default.aspx?msg=logged+off AppPath:
2018-09-24 11:52:51 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:52:51 http://192.168.0.31/bugs.aspx elapsed milliseconds:0005
2018-09-24 11:52:51 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:52:51 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:52:51 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2018-09-24 11:52:51 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:52:51 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:52:51 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:52:56 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:52:56 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:52:56 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 18
2018-09-24 11:52:56 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','open','In-process','Programming Completed','QC Completed','Re-Open','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:52:56 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:52:59 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:52:59 http://192.168.0.31/queries.aspx elapsed milliseconds:0000
2018-09-24 11:52:59 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:52:59 http://192.168.0.31/queries.aspx elapsed milliseconds:0003
2018-09-24 11:53:11 http://192.168.0.31/edit_query.aspx?id=18 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:53:11 http://192.168.0.31/edit_query.aspx?id=18 elapsed milliseconds:0000
2018-09-24 11:53:11 http://192.168.0.31/edit_query.aspx?id=18 sql=
/* populate org/user dropdowns */
select og_id, og_name from orgs order by og_name;
select us_id, us_username from users order by us_username
2018-09-24 11:53:11 http://192.168.0.31/edit_query.aspx?id=18 elapsed milliseconds:0000
2018-09-24 11:53:11 http://192.168.0.31/edit_query.aspx?id=18 sql=
select
				qu_desc, qu_sql, isnull(qu_user,0) [qu_user], isnull(qu_org,0) [qu_org]
				from queries where qu_id = 18
2018-09-24 11:53:11 http://192.168.0.31/edit_query.aspx?id=18 elapsed milliseconds:0001
2018-09-24 11:53:31 http://192.168.0.31/edit_query.aspx?id=18 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:53:31 http://192.168.0.31/edit_query.aspx?id=18 elapsed milliseconds:0000
2018-09-24 11:53:31 http://192.168.0.31/edit_query.aspx?id=18 sql=
select count(1) from queries where qu_desc = N'Deployment view' and qu_id <> 18
2018-09-24 11:53:31 http://192.168.0.31/edit_query.aspx?id=18 sql=
update queries set
				qu_desc = N'Deployment view',
				qu_sql = N'select isnull(pr_background_color,''#ffffff''), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'''') [project], isnull(bg_project_custom_dropdown_value1,'''') [Version], isnull(og_name,'''') [organization], isnull(ct_name,'''') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'''') [priority], isnull(asg.us_username,'''') [assigned to], 
 --isnull(st_name,'''') [status],
 isnull(case when st_name IN(''Waiting for approval'',''Approved'',''Rejected'',''open'',''In-process'',''Programming Completed'',''Re-Open'',''Hold'') then  ''New'' else st_name end,'''')[status],
 isnull(lu.us_username,'''') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = $ME 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
 order by bg_id desc',
				qu_user = 0,
				qu_org = 1
				where qu_id = 18
2018-09-24 11:53:31 http://192.168.0.31/edit_query.aspx?id=18 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:53:31 http://192.168.0.31/edit_query.aspx?id=18 elapsed milliseconds:0000
2018-09-24 11:53:31 http://192.168.0.31/edit_query.aspx?id=18 sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:53:31 http://192.168.0.31/edit_query.aspx?id=18 elapsed milliseconds:0002
2018-09-24 11:53:33 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:53:33 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:53:33 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:53:33 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:53:33 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 18
2018-09-24 11:53:33 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','open','In-process','Programming Completed','Re-Open','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:53:33 http://192.168.0.31/bugs.aspx elapsed milliseconds:0012
2018-09-24 11:54:19 http://192.168.0.31/ajax.aspx?bugid=16 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:54:19 http://192.168.0.31/ajax.aspx?bugid=16 elapsed milliseconds:0001
2018-09-24 11:54:19 http://192.168.0.31/ajax.aspx?bugid=16 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 16
2018-09-24 11:54:19 http://192.168.0.31/ajax.aspx?bugid=16 elapsed milliseconds:0006
2018-09-24 11:54:19 http://192.168.0.31/ajax.aspx?bugid=16 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 16
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:54:19 http://192.168.0.31/ajax.aspx?bugid=16 elapsed milliseconds:0019
2018-09-24 11:54:23 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:54:23 http://192.168.0.31/queries.aspx elapsed milliseconds:0000
2018-09-24 11:54:23 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:54:23 http://192.168.0.31/queries.aspx elapsed milliseconds:0001
2018-09-24 11:54:28 http://192.168.0.31/edit_query.aspx?id=13 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:54:28 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:54:28 http://192.168.0.31/edit_query.aspx?id=13 sql=
/* populate org/user dropdowns */
select og_id, og_name from orgs order by og_name;
select us_id, us_username from users order by us_username
2018-09-24 11:54:28 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:54:28 http://192.168.0.31/edit_query.aspx?id=13 sql=
select
				qu_desc, qu_sql, isnull(qu_user,0) [qu_user], isnull(qu_org,0) [qu_org]
				from queries where qu_id = 13
2018-09-24 11:54:28 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:54:52 http://192.168.0.31/edit_query.aspx?id=13 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:54:52 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:54:52 http://192.168.0.31/edit_query.aspx?id=13 sql=
select count(1) from queries where qu_desc = N'Deployment' and qu_id <> 13
2018-09-24 11:54:52 http://192.168.0.31/edit_query.aspx?id=13 sql=
update queries set
				qu_desc = N'Deployment',
				qu_sql = N'select isnull(pr_background_color,''#ffffff''), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'''') [project], isnull(bg_project_custom_dropdown_value1,'''') [Version], isnull(og_name,'''') [organization], isnull(ct_name,'''') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'''') [priority], isnull(asg.us_username,'''') [assigned to], 
 --isnull(st_name,'''') [status],
 isnull(case when st_name IN(''Waiting for approval'',''Approved'',''Rejected'',''open'',''In-process'',''Programming Completed'',''Re-Open'',''Hold'') then  ''New'' else st_name end,'''')[status],
 isnull(lu.us_username,'''') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = $ME 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
 order by bg_id desc
',
				qu_user = 0,
				qu_org = 6
				where qu_id = 13
2018-09-24 11:54:52 http://192.168.0.31/edit_query.aspx?id=13 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:54:52 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:54:52 http://192.168.0.31/edit_query.aspx?id=13 sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:54:52 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0003
2018-09-24 11:54:53 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:54:53 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:54:53 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:54:53 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:54:53 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 18
2018-09-24 11:54:53 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','open','In-process','Programming Completed','Re-Open','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:54:53 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:55:02 http://192.168.0.31/ajax.aspx?bugid=25 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:55:02 http://192.168.0.31/ajax.aspx?bugid=25 elapsed milliseconds:0001
2018-09-24 11:55:02 http://192.168.0.31/ajax.aspx?bugid=25 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 25
2018-09-24 11:55:02 http://192.168.0.31/ajax.aspx?bugid=25 elapsed milliseconds:0005
2018-09-24 11:55:02 http://192.168.0.31/ajax.aspx?bugid=25 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 25
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 11:55:02 http://192.168.0.31/ajax.aspx?bugid=25 elapsed milliseconds:0015
2018-09-24 11:55:02 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:55:02 http://192.168.0.31/queries.aspx elapsed milliseconds:0000
2018-09-24 11:55:02 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:55:02 http://192.168.0.31/queries.aspx elapsed milliseconds:0001
2018-09-24 11:55:06 http://192.168.0.31/edit_query.aspx?id=18 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:55:06 http://192.168.0.31/edit_query.aspx?id=18 elapsed milliseconds:0000
2018-09-24 11:55:06 http://192.168.0.31/edit_query.aspx?id=18 sql=
/* populate org/user dropdowns */
select og_id, og_name from orgs order by og_name;
select us_id, us_username from users order by us_username
2018-09-24 11:55:06 http://192.168.0.31/edit_query.aspx?id=18 elapsed milliseconds:0000
2018-09-24 11:55:06 http://192.168.0.31/edit_query.aspx?id=18 sql=
select
				qu_desc, qu_sql, isnull(qu_user,0) [qu_user], isnull(qu_org,0) [qu_org]
				from queries where qu_id = 18
2018-09-24 11:55:06 http://192.168.0.31/edit_query.aspx?id=18 elapsed milliseconds:0000
2018-09-24 11:55:13 http://192.168.0.31/edit_query.aspx?id=18 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:55:13 http://192.168.0.31/edit_query.aspx?id=18 elapsed milliseconds:0000
2018-09-24 11:55:13 http://192.168.0.31/edit_query.aspx?id=18 sql=
select count(1) from queries where qu_desc = N'Deployment view' and qu_id <> 18
2018-09-24 11:55:13 http://192.168.0.31/edit_query.aspx?id=18 sql=
update queries set
				qu_desc = N'Deployment view',
				qu_sql = N'select isnull(pr_background_color,''#ffffff''), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'''') [project], isnull(bg_project_custom_dropdown_value1,'''') [Version], isnull(og_name,'''') [organization], isnull(ct_name,'''') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'''') [priority], isnull(asg.us_username,'''') [assigned to], 
 --isnull(st_name,'''') [status],
 isnull(case when st_name IN(''Waiting for approval'',''Approved'',''Rejected'',''open'',''In-process'',''Programing Completed'',''Re-Open'',''Hold'') then  ''New'' else st_name end,'''')[status],
 isnull(lu.us_username,'''') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = $ME 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
 order by bg_id desc',
				qu_user = 0,
				qu_org = 1
				where qu_id = 18
2018-09-24 11:55:13 http://192.168.0.31/edit_query.aspx?id=18 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:55:13 http://192.168.0.31/edit_query.aspx?id=18 elapsed milliseconds:0000
2018-09-24 11:55:13 http://192.168.0.31/edit_query.aspx?id=18 sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:55:13 http://192.168.0.31/edit_query.aspx?id=18 elapsed milliseconds:0001
2018-09-24 11:55:16 http://192.168.0.31/edit_query.aspx?id=13 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:55:16 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:55:16 http://192.168.0.31/edit_query.aspx?id=13 sql=
/* populate org/user dropdowns */
select og_id, og_name from orgs order by og_name;
select us_id, us_username from users order by us_username
2018-09-24 11:55:16 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:55:16 http://192.168.0.31/edit_query.aspx?id=13 sql=
select
				qu_desc, qu_sql, isnull(qu_user,0) [qu_user], isnull(qu_org,0) [qu_org]
				from queries where qu_id = 13
2018-09-24 11:55:16 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:55:22 http://192.168.0.31/edit_query.aspx?id=13 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:55:22 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:55:22 http://192.168.0.31/edit_query.aspx?id=13 sql=
select count(1) from queries where qu_desc = N'Deployment' and qu_id <> 13
2018-09-24 11:55:22 http://192.168.0.31/edit_query.aspx?id=13 sql=
update queries set
				qu_desc = N'Deployment',
				qu_sql = N'select isnull(pr_background_color,''#ffffff''), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'''') [project], isnull(bg_project_custom_dropdown_value1,'''') [Version], isnull(og_name,'''') [organization], isnull(ct_name,'''') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'''') [priority], isnull(asg.us_username,'''') [assigned to], 
 --isnull(st_name,'''') [status],
 isnull(case when st_name IN(''Waiting for approval'',''Approved'',''Rejected'',''open'',''In-process'',''Programing Completed'',''Re-Open'',''Hold'') then  ''New'' else st_name end,'''')[status],
 isnull(lu.us_username,'''') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = $ME 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
 order by bg_id desc
',
				qu_user = 0,
				qu_org = 6
				where qu_id = 13
2018-09-24 11:55:22 http://192.168.0.31/edit_query.aspx?id=13 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:55:22 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0000
2018-09-24 11:55:22 http://192.168.0.31/edit_query.aspx?id=13 sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:55:22 http://192.168.0.31/edit_query.aspx?id=13 elapsed milliseconds:0001
2018-09-24 11:55:24 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:55:24 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:55:24 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:55:24 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:55:24 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 18
2018-09-24 11:55:24 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected','open','In-process','Programing Completed','Re-Open','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:55:24 http://192.168.0.31/bugs.aspx elapsed milliseconds:0013
2018-09-24 11:55:37 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '36078e6c-69c6-4612-ad23-54b964bc7828'
and us_active = 1
2018-09-24 11:55:37 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:55:37 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 16
2018-09-24 11:55:37 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status], 
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected', 'Ready to deploy','Hold') then 'New' else st_name end,'')[status], 
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc 
2018-09-24 11:55:37 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:56:04 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'36078e6c-69c6-4612-ad23-54b964bc7828'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 11:56:04 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:56:07 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:56:07 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'dev1'
2018-09-24 11:56:07 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:56:07 http://192.168.0.31/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 2
2018-09-24 11:56:07 http://192.168.0.31/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'dev1'
2018-09-24 11:56:07 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:56:07 http://192.168.0.31/default.aspx?msg=logged+off guid=61288573-9305-4fac-a810-5376d4a695e5
2018-09-24 11:56:07 http://192.168.0.31/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('61288573-9305-4fac-a810-5376d4a695e5', 2)
2018-09-24 11:56:07 http://192.168.0.31/default.aspx?msg=logged+off AppPath:
2018-09-24 11:56:07 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '61288573-9305-4fac-a810-5376d4a695e5';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '61288573-9305-4fac-a810-5376d4a695e5'
and us_active = 1
2018-09-24 11:56:07 http://192.168.0.31/bugs.aspx elapsed milliseconds:0009
2018-09-24 11:56:07 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 2
or isnull(qu_org,0) = 2
order by qu_desc
2018-09-24 11:56:07 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:56:07 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 2)
2018-09-24 11:56:07 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:56:07 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected', 'Ready to deploy','Hold') then  'New' else st_name end,'')[status],
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 2 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 2
					and pu_permission_level = 0)) order by bg_id desc

2018-09-24 11:56:07 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:56:40 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '61288573-9305-4fac-a810-5376d4a695e5';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '61288573-9305-4fac-a810-5376d4a695e5'
and us_active = 1
2018-09-24 11:56:40 http://192.168.0.31/queries.aspx elapsed milliseconds:0001
2018-09-24 11:56:40 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>rename</a>' [rename],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete]
			from queries
			inner join users on qu_user = us_id
			where isnull(qu_user,0) = 2
			order by qu_desc
2018-09-24 11:56:40 http://192.168.0.31/queries.aspx elapsed milliseconds:0006
2018-09-24 11:56:42 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'61288573-9305-4fac-a810-5376d4a695e5'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 11:56:42 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:56:46 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:56:46 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2018-09-24 11:56:46 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:56:46 http://192.168.0.31/default.aspx?msg=logged+off failed attempt count for admin:0
2018-09-24 11:56:46 http://192.168.0.31/default.aspx?msg=logged+off User admin entered an incorrect password.
2018-09-24 11:56:49 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:56:49 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2018-09-24 11:56:49 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:56:49 http://192.168.0.31/default.aspx?msg=logged+off failed attempt count for admin:1
2018-09-24 11:56:49 http://192.168.0.31/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2018-09-24 11:56:49 http://192.168.0.31/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'admin'
2018-09-24 11:56:49 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 11:56:49 http://192.168.0.31/default.aspx?msg=logged+off guid=3606784e-ffc8-41d3-a5e5-dfd9e3d71364
2018-09-24 11:56:49 http://192.168.0.31/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('3606784e-ffc8-41d3-a5e5-dfd9e3d71364', 1)
2018-09-24 11:56:49 http://192.168.0.31/default.aspx?msg=logged+off AppPath:
2018-09-24 11:56:49 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364'
and us_active = 1
2018-09-24 11:56:49 http://192.168.0.31/bugs.aspx elapsed milliseconds:0012
2018-09-24 11:56:49 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:56:49 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:56:49 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2018-09-24 11:56:49 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:56:49 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:56:49 http://192.168.0.31/bugs.aspx elapsed milliseconds:0002
2018-09-24 11:56:51 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364'
and us_active = 1
2018-09-24 11:56:51 http://192.168.0.31/queries.aspx elapsed milliseconds:0000
2018-09-24 11:56:51 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:56:51 http://192.168.0.31/queries.aspx elapsed milliseconds:0004
2018-09-24 11:57:00 http://192.168.0.31/edit_query.aspx?id=16 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364'
and us_active = 1
2018-09-24 11:57:00 http://192.168.0.31/edit_query.aspx?id=16 elapsed milliseconds:0000
2018-09-24 11:57:00 http://192.168.0.31/edit_query.aspx?id=16 sql=
/* populate org/user dropdowns */
select og_id, og_name from orgs order by og_name;
select us_id, us_username from users order by us_username
2018-09-24 11:57:00 http://192.168.0.31/edit_query.aspx?id=16 elapsed milliseconds:0000
2018-09-24 11:57:00 http://192.168.0.31/edit_query.aspx?id=16 sql=
select
				qu_desc, qu_sql, isnull(qu_user,0) [qu_user], isnull(qu_org,0) [qu_org]
				from queries where qu_id = 16
2018-09-24 11:57:00 http://192.168.0.31/edit_query.aspx?id=16 elapsed milliseconds:0000
2018-09-24 11:57:09 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364'
and us_active = 1
2018-09-24 11:57:09 http://192.168.0.31/queries.aspx elapsed milliseconds:0000
2018-09-24 11:57:09 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 11:57:09 http://192.168.0.31/queries.aspx elapsed milliseconds:0001
2018-09-24 11:57:19 http://192.168.0.31/edit_query.aspx?id=12 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364'
and us_active = 1
2018-09-24 11:57:19 http://192.168.0.31/edit_query.aspx?id=12 elapsed milliseconds:0000
2018-09-24 11:57:19 http://192.168.0.31/edit_query.aspx?id=12 sql=
/* populate org/user dropdowns */
select og_id, og_name from orgs order by og_name;
select us_id, us_username from users order by us_username
2018-09-24 11:57:19 http://192.168.0.31/edit_query.aspx?id=12 elapsed milliseconds:0000
2018-09-24 11:57:19 http://192.168.0.31/edit_query.aspx?id=12 sql=
select
				qu_desc, qu_sql, isnull(qu_user,0) [qu_user], isnull(qu_org,0) [qu_org]
				from queries where qu_id = 12
2018-09-24 11:57:20 http://192.168.0.31/edit_query.aspx?id=12 elapsed milliseconds:0001
2018-09-24 11:57:23 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364'
and us_active = 1
2018-09-24 11:57:23 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:57:23 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 11:57:23 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:57:23 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2018-09-24 11:57:23 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:57:23 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:57:28 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364'
and us_active = 1
2018-09-24 11:57:28 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:57:28 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 16
2018-09-24 11:57:28 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by], 
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to], 
 --isnull(st_name,'') [status], 
 isnull(case when st_name IN('Waiting for approval','Approved','Rejected', 'Ready to deploy','Hold') then 'New' else st_name end,'')[status], 
 isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on] 
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 left outer join users asg on asg.us_id = bg_assigned_to_user 
 left outer join users lu on lu.us_id = bg_last_updated_user 
 left outer join projects on pj_id = bg_project 
 left outer join orgs on og_id = bg_org 
 left outer join categories on ct_id = bg_category 
 left outer join priorities on pr_id = bg_priority 
 left outer join statuses on st_id = bg_status 
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc 
2018-09-24 11:57:28 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:57:36 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '3606784e-ffc8-41d3-a5e5-dfd9e3d71364'
and us_active = 1
2018-09-24 11:57:36 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 11:57:36 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2018-09-24 11:57:36 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 11:57:36 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 11:57:42 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'3606784e-ffc8-41d3-a5e5-dfd9e3d71364'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 11:57:42 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:59:24 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:59:25 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:59:44 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:59:45 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:59:46 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 11:59:48 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 12:08:37 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 12:08:37 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2018-09-24 12:08:37 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 12:08:37 http://192.168.0.31/default.aspx?msg=logged+off failed attempt count for admin:0
2018-09-24 12:08:37 http://192.168.0.31/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2018-09-24 12:08:37 http://192.168.0.31/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'admin'
2018-09-24 12:08:37 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0000
2018-09-24 12:08:37 http://192.168.0.31/default.aspx?msg=logged+off guid=4fcadf43-24c9-42c6-81d4-9102965939b6
2018-09-24 12:08:37 http://192.168.0.31/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('4fcadf43-24c9-42c6-81d4-9102965939b6', 1)
2018-09-24 12:08:37 http://192.168.0.31/default.aspx?msg=logged+off AppPath:
2018-09-24 12:08:37 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '4fcadf43-24c9-42c6-81d4-9102965939b6';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '4fcadf43-24c9-42c6-81d4-9102965939b6'
and us_active = 1
2018-09-24 12:08:37 http://192.168.0.31/bugs.aspx elapsed milliseconds:0022
2018-09-24 12:08:37 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 12:08:37 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 12:08:37 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2018-09-24 12:08:37 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 12:08:37 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 12:08:37 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 12:08:48 http://192.168.0.31/search_text.aspx?query=wcc sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '4fcadf43-24c9-42c6-81d4-9102965939b6';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '4fcadf43-24c9-42c6-81d4-9102965939b6'
and us_active = 1
2018-09-24 12:08:48 http://192.168.0.31/search_text.aspx?query=wcc elapsed milliseconds:0000
2018-09-24 12:08:48 http://192.168.0.31/search_text.aspx?query=wcc sql=

create table #0e838b0e84aa4080b450ff45125bfecc
(
temp_bg_id int,
temp_bp_id int,
temp_source varchar(30),
temp_score float,
temp_text nvarchar(3000)
)
    insert into #0e838b0e84aa4080b450ff45125bfecc values(9,0,'desc',1,N'<span class=''highlighted''>WCC</span> - Search window')
insert into #0e838b0e84aa4080b450ff45125bfecc values(10,0,'desc',1,N'<span class=''highlighted''>WCC</span> - Edit window')
insert into #0e838b0e84aa4080b450ff45125bfecc values(35,0,'desc',1,N'<span class=''highlighted''>WCC</span> Search window')
insert into #0e838b0e84aa4080b450ff45125bfecc values(34,0,'desc',1,N'<span class=''highlighted''>WCC</span> - Edit window')
insert into #0e838b0e84aa4080b450ff45125bfecc values(2,2,'post',0.3125,N'In the <span class=''highlighted''>WCC</span> Search window, if searching by the Item field, we need to also 

search the Task Detail rows, in case the Item of the Search is part of a 

multi-Item task.
Please let me know if you need any other info')
insert into #0e838b0e84aa4080b450ff45125bfecc values(19,23,'post',0.25,N'In <span class=''highlighted''>WCC</span>, in Edit window, we need to be able to edit the Quantity Delivered
1.	This needs to be enabled regardless of Task status (Open, In Process; 

but NOT Closed)
a.	Question  If Qty delivered is set to 0, is a new task created? Is 

this a configurable setting?
2.	In the Mobile application, we need to be able to assign to me as 2nd 

Employee. Trevor may have already sent')

select '#ffffff', bg_id [id], bg_short_desc [desc] ,
	temp_source [search_source] ,
	temp_text [search_text],
	bg_reported_date [date],
	isnull(st_name,'') [status],
	temp_score [$SCORE]
from bugs
inner join #0e838b0e84aa4080b450ff45125bfecc t on t.temp_bg_id = bg_id and t.temp_bp_id = 0
left outer join statuses on st_id = bg_status
where /* ALTER_HERE */  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) 

union

select '#ffffff', bg_id, bg_short_desc,
	bp_type + ',' + convert(varchar,bp_id) COLLATE DATABASE_DEFAULT,
	temp_text,
	bp_date,
	isnull(st_name,''),
	temp_score
from bugs
inner join #0e838b0e84aa4080b450ff45125bfecc t on t.temp_bg_id = bg_id
inner join bug_posts on temp_bp_id = bp_id
left outer join statuses on st_id = bg_status
where /* ALTER_HERE */  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) 

order by t.temp_score desc, bg_id desc

drop table #0e838b0e84aa4080b450ff45125bfecc


2018-09-24 12:08:48 http://192.168.0.31/search_text.aspx?query=wcc elapsed milliseconds:0234
2018-09-24 12:08:48 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '4fcadf43-24c9-42c6-81d4-9102965939b6';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '4fcadf43-24c9-42c6-81d4-9102965939b6'
and us_active = 1
2018-09-24 12:08:48 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 12:08:48 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 12:08:48 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 12:08:50 http://192.168.0.31/search_text.aspx?query=wcc sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '4fcadf43-24c9-42c6-81d4-9102965939b6';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '4fcadf43-24c9-42c6-81d4-9102965939b6'
and us_active = 1
2018-09-24 12:08:50 http://192.168.0.31/search_text.aspx?query=wcc elapsed milliseconds:0000
2018-09-24 12:08:50 http://192.168.0.31/search_text.aspx?query=wcc sql=

create table #f3005eb956f445cfa54a833a7700875e
(
temp_bg_id int,
temp_bp_id int,
temp_source varchar(30),
temp_score float,
temp_text nvarchar(3000)
)
    insert into #f3005eb956f445cfa54a833a7700875e values(9,0,'desc',1,N'<span class=''highlighted''>WCC</span> - Search window')
insert into #f3005eb956f445cfa54a833a7700875e values(10,0,'desc',1,N'<span class=''highlighted''>WCC</span> - Edit window')
insert into #f3005eb956f445cfa54a833a7700875e values(35,0,'desc',1,N'<span class=''highlighted''>WCC</span> Search window')
insert into #f3005eb956f445cfa54a833a7700875e values(34,0,'desc',1,N'<span class=''highlighted''>WCC</span> - Edit window')
insert into #f3005eb956f445cfa54a833a7700875e values(2,2,'post',0.3125,N'In the <span class=''highlighted''>WCC</span> Search window, if searching by the Item field, we need to also 

search the Task Detail rows, in case the Item of the Search is part of a 

multi-Item task.
Please let me know if you need any other info')
insert into #f3005eb956f445cfa54a833a7700875e values(19,23,'post',0.25,N'In <span class=''highlighted''>WCC</span>, in Edit window, we need to be able to edit the Quantity Delivered
1.	This needs to be enabled regardless of Task status (Open, In Process; 

but NOT Closed)
a.	Question  If Qty delivered is set to 0, is a new task created? Is 

this a configurable setting?
2.	In the Mobile application, we need to be able to assign to me as 2nd 

Employee. Trevor may have already sent')

select '#ffffff', bg_id [id], bg_short_desc [desc] ,
	temp_source [search_source] ,
	temp_text [search_text],
	bg_reported_date [date],
	isnull(st_name,'') [status],
	temp_score [$SCORE]
from bugs
inner join #f3005eb956f445cfa54a833a7700875e t on t.temp_bg_id = bg_id and t.temp_bp_id = 0
left outer join statuses on st_id = bg_status
where /* ALTER_HERE */  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) 

union

select '#ffffff', bg_id, bg_short_desc,
	bp_type + ',' + convert(varchar,bp_id) COLLATE DATABASE_DEFAULT,
	temp_text,
	bp_date,
	isnull(st_name,''),
	temp_score
from bugs
inner join #f3005eb956f445cfa54a833a7700875e t on t.temp_bg_id = bg_id
inner join bug_posts on temp_bp_id = bp_id
left outer join statuses on st_id = bg_status
where /* ALTER_HERE */  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) 

order by t.temp_score desc, bg_id desc

drop table #f3005eb956f445cfa54a833a7700875e


2018-09-24 12:08:50 http://192.168.0.31/search_text.aspx?query=wcc elapsed milliseconds:0026
2018-09-24 12:08:50 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '4fcadf43-24c9-42c6-81d4-9102965939b6';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '4fcadf43-24c9-42c6-81d4-9102965939b6'
and us_active = 1
2018-09-24 12:08:50 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 12:08:50 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 12:08:50 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 12:09:04 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'4fcadf43-24c9-42c6-81d4-9102965939b6'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 12:09:04 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 12:37:18  caught exception in util.set_context:Request is not available in this context
2018-09-24 12:37:18  threadproc_votes
2018-09-24 12:37:18  sql=

if exists (select * from dbo.sysobjects where id = object_id(N'[votes_view]'))
drop view [votes_view]
2018-09-24 12:37:18  started creating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 12:37:18  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 12:37:18 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 12:37:18  sql=

create view votes_view as
select bu_bug as vote_bug, sum(bu_vote) as vote_total
from bug_user
group by bu_bug
having sum(bu_vote) > 0
2018-09-24 12:37:18  sql=

select bu_bug, count(1)
from bug_user 
where bu_vote = 1
group by bu_bug
2018-09-24 12:37:18  elapsed milliseconds:0007
2018-09-24 12:37:18 http://192.168.0.31/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2018-09-24 12:37:18 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0003
2018-09-24 12:37:18 http://192.168.0.31/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2018-09-24 12:37:18 http://192.168.0.31/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'admin'
2018-09-24 12:37:18 http://192.168.0.31/default.aspx?msg=logged+off elapsed milliseconds:0001
2018-09-24 12:37:18 http://192.168.0.31/default.aspx?msg=logged+off guid=b3bb3a2c-91b6-4709-adc1-0dacf6d91215
2018-09-24 12:37:18 http://192.168.0.31/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('b3bb3a2c-91b6-4709-adc1-0dacf6d91215', 1)
2018-09-24 12:37:18  elapsed milliseconds:0126
2018-09-24 12:37:18  sql=

select bg_id, 	

isnull(bg_tags,'') bg_tags,
bg_short_desc
from bugs
2018-09-24 12:37:18  elapsed milliseconds:0031
2018-09-24 12:37:18 http://192.168.0.31/default.aspx?msg=logged+off AppPath:
2018-09-24 12:37:18  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
2018-09-24 12:37:18 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:37:18 http://192.168.0.31/bugs.aspx elapsed milliseconds:0007
2018-09-24 12:37:18 http://192.168.0.31/bugs.aspx sql=

/* custom columns */ select sc.name, st.[name] [datatype], 
case when st.[name] = 'nvarchar' or st.[name] = 'nchar' then sc.length/2 else sc.length end as [length], 
sc.xprec, sc.xscale, sc.isnullable,
mm.text [default value], 
dflts.name [default name], 
isnull(ccm_dropdown_type,'') [dropdown type],
isnull(ccm_dropdown_vals,'') [vals],
isnull(ccm_sort_seq, sc.colorder) [column order],
sc.colorder
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
left outer join syscomments mm on sc.cdefault = mm.id
left outer join custom_col_metadata on ccm_colorder = sc.colorder
left outer join sysobjects dflts on dflts.id = mm.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
order by sc.id, isnull(ccm_sort_seq,sc.colorder)
2018-09-24 12:37:18  elapsed milliseconds:0046
2018-09-24 12:37:18  done creating Lucene index
2018-09-24 12:37:18 http://192.168.0.31/bugs.aspx elapsed milliseconds:0064
2018-09-24 12:37:18 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 12:37:18 http://192.168.0.31/bugs.aspx elapsed milliseconds:0019
2018-09-24 12:37:18 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2018-09-24 12:37:18 http://192.168.0.31/bugs.aspx elapsed milliseconds:0020
2018-09-24 12:37:18 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 12:37:18 http://192.168.0.31/bugs.aspx elapsed milliseconds:0013
2018-09-24 12:37:22 http://192.168.0.31/ajax.aspx?bugid=35 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:37:22 http://192.168.0.31/ajax.aspx?bugid=35 elapsed milliseconds:0000
2018-09-24 12:37:22 http://192.168.0.31/ajax.aspx?bugid=35 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 35
2018-09-24 12:37:22 http://192.168.0.31/ajax.aspx?bugid=35 elapsed milliseconds:0004
2018-09-24 12:37:22 http://192.168.0.31/ajax.aspx?bugid=35 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 35
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 12:37:22 http://192.168.0.31/ajax.aspx?bugid=35 elapsed milliseconds:0010
2018-09-24 12:37:22 http://192.168.0.31/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:37:23 http://192.168.0.31/admin.aspx elapsed milliseconds:0000
2018-09-24 12:37:23 http://192.168.0.31/admin.aspx sql=
select count(1) from bugs
2018-09-24 12:37:24 http://192.168.0.31/users.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:37:24 http://192.168.0.31/users.aspx elapsed milliseconds:0000
2018-09-24 12:37:24 http://192.168.0.31/users.aspx sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2018-09-24 12:37:24 http://192.168.0.31/users.aspx elapsed milliseconds:0012
2018-09-24 12:38:35 http://192.168.0.31/edit_user.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:38:35 http://192.168.0.31/edit_user.aspx elapsed milliseconds:0000
2018-09-24 12:38:35 http://192.168.0.31/edit_user.aspx sql=

				select pj_id, pj_name,
				isnull(pu_permission_level,2) [pu_permission_level],
				isnull(pu_auto_subscribe,0) [pu_auto_subscribe],
				isnull(pu_admin,0) [pu_admin]
				from projects
				left outer join project_user_xref on pj_id = pu_project
				and pu_user = 0
				order by pj_name;/* populate query dropdown */
		    declare @org int
		    set @org = null
		    select @org = us_org from users where us_id = 0

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 0
			or isnull(qu_org,0) = isnull(@org,-1)
			order by qu_desc;/* populate org dropdown 1 */
				select og_id, og_name
				from orgs
				order by og_name;
2018-09-24 12:38:35 http://192.168.0.31/edit_user.aspx elapsed milliseconds:0038
2018-09-24 12:38:40 http://192.168.0.31/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:38:40 http://192.168.0.31/admin.aspx elapsed milliseconds:0000
2018-09-24 12:38:40 http://192.168.0.31/admin.aspx sql=
select count(1) from bugs
2018-09-24 12:38:45 http://192.168.0.31/users.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:38:45 http://192.168.0.31/users.aspx elapsed milliseconds:0000
2018-09-24 12:38:45 http://192.168.0.31/users.aspx sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2018-09-24 12:38:45 http://192.168.0.31/users.aspx elapsed milliseconds:0009
2018-09-24 12:38:45 http://192.168.0.31/edit_user.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:38:45 http://192.168.0.31/edit_user.aspx elapsed milliseconds:0000
2018-09-24 12:38:45 http://192.168.0.31/edit_user.aspx sql=

				select pj_id, pj_name,
				isnull(pu_permission_level,2) [pu_permission_level],
				isnull(pu_auto_subscribe,0) [pu_auto_subscribe],
				isnull(pu_admin,0) [pu_admin]
				from projects
				left outer join project_user_xref on pj_id = pu_project
				and pu_user = 0
				order by pj_name;/* populate query dropdown */
		    declare @org int
		    set @org = null
		    select @org = us_org from users where us_id = 0

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 0
			or isnull(qu_org,0) = isnull(@org,-1)
			order by qu_desc;/* populate org dropdown 1 */
				select og_id, og_name
				from orgs
				order by og_name;
2018-09-24 12:38:45 http://192.168.0.31/edit_user.aspx elapsed milliseconds:0000
2018-09-24 12:38:58 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:38:58 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 12:38:58 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 12:38:58 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 12:38:58 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2018-09-24 12:38:58 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 12:38:58 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 12:39:15 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:39:15 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 12:39:15 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 11
2018-09-24 12:39:15 http://192.168.0.31/bugs.aspx sql=
select bg_id ,bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc],
 isnull(pj_name,'') [project], 
isnull(bg_project_custom_dropdown_value1,'') [Version],
 isnull(og_name,'') [organization],
 isnull(ct_name,'') [category], 
rpt.us_username [reported by],
 bg_reported_date [reported on],  
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Programing Completed','QC Completed','Re-Open','Ready to deploy','Hold') then  'In-Process' else st_name end,'')[status],
 bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
-- left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 12:39:15 http://192.168.0.31/bugs.aspx elapsed milliseconds:0016
2018-09-24 12:39:20 http://192.168.0.31/ajax.aspx?bugid=22 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:39:20 http://192.168.0.31/ajax.aspx?bugid=22 elapsed milliseconds:0001
2018-09-24 12:39:20 http://192.168.0.31/ajax.aspx?bugid=22 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 22
2018-09-24 12:39:20 http://192.168.0.31/ajax.aspx?bugid=22 elapsed milliseconds:0011
2018-09-24 12:39:20 http://192.168.0.31/ajax.aspx?bugid=22 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 22
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 12:39:20 http://192.168.0.31/ajax.aspx?bugid=22 elapsed milliseconds:0010
2018-09-24 12:39:25 http://192.168.0.31/queries.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:39:25 http://192.168.0.31/queries.aspx elapsed milliseconds:0000
2018-09-24 12:39:25 http://192.168.0.31/queries.aspx sql=
select
			qu_desc [query],
			case
				when isnull(qu_user,0) = 0 and isnull(qu_org,0) is null then 'everybody'
				when isnull(qu_user,0) <> 0 then 'user:' + us_username
				when isnull(qu_org,0) <> 0 then 'org:' + og_name
				else ' '
				end [visibility],
			'<a href=bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>view list</a>' [view list],
			'<a target=_blank href=print_bugs.aspx?qu_id=' + convert(varchar,qu_id) + '>print list</a>' [print list],
			'<a target=_blank href=print_bugs.aspx?format=excel&qu_id=' + convert(varchar,qu_id) + '>export as excel</a>' [export as excel],
			'<a target=_blank href=print_bugs2.aspx?qu_id=' + convert(varchar,qu_id) + '>print detail</a>' [print list<br>with detail],
			'<a href=edit_query.aspx?id=' + convert(varchar,qu_id) + '>edit</a>' [edit],
			'<a href=delete_query.aspx?id=' + convert(varchar,qu_id) + '>delete</a>' [delete],
			replace(convert(nvarchar(4000),qu_sql), char(10),'<br>') [sql]
			from queries
			left outer join users on qu_user = us_id
			left outer join orgs on qu_org = og_id
			where 1 = 0 /* all */
			or isnull(qu_user,0) = 1
			or isnull(qu_user,0) = 0
			order by qu_desc
2018-09-24 12:39:25 http://192.168.0.31/queries.aspx elapsed milliseconds:0008
2018-09-24 12:39:33 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:39:33 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 12:39:33 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 12:39:33 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 12:39:33 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 11
2018-09-24 12:39:33 http://192.168.0.31/bugs.aspx sql=
select bg_id ,bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc],
 isnull(pj_name,'') [project], 
isnull(bg_project_custom_dropdown_value1,'') [Version],
 isnull(og_name,'') [organization],
 isnull(ct_name,'') [category], 
rpt.us_username [reported by],
 bg_reported_date [reported on],  
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Programing Completed','QC Completed','Re-Open','Ready to deploy','Hold') then  'In-Process' else st_name end,'')[status],
 bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
-- left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 12:39:33 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 12:39:35 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:39:35 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 12:39:35 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2018-09-24 12:39:35 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 12:39:35 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 12:39:47 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 12:39:47 http://192.168.0.31/bugs.aspx elapsed milliseconds:0000
2018-09-24 12:39:47 http://192.168.0.31/bugs.aspx sql=
select qu_sql from queries where qu_id = 11
2018-09-24 12:39:47 http://192.168.0.31/bugs.aspx sql=
select bg_id ,bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc],
 isnull(pj_name,'') [project], 
isnull(bg_project_custom_dropdown_value1,'') [Version],
 isnull(og_name,'') [organization],
 isnull(ct_name,'') [category], 
rpt.us_username [reported by],
 bg_reported_date [reported on],  
 --isnull(st_name,'') [status],
 isnull(case when st_name IN('Programing Completed','QC Completed','Re-Open','Ready to deploy','Hold') then  'In-Process' else st_name end,'')[status],
 bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
-- left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 12:39:47 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 14:22:59  caught exception in util.set_context:Request is not available in this context
2018-09-24 14:22:59  threadproc_votes
2018-09-24 14:22:59  sql=

if exists (select * from dbo.sysobjects where id = object_id(N'[votes_view]'))
drop view [votes_view]
2018-09-24 14:22:59  started creating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 14:22:59  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 14:22:59 http://192.168.0.31/ajax.aspx?bugid=25 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
and us_active = 1
2018-09-24 14:22:59 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'b3bb3a2c-91b6-4709-adc1-0dacf6d91215'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 14:22:59  sql=

create view votes_view as
select bu_bug as vote_bug, sum(bu_vote) as vote_total
from bug_user
group by bu_bug
having sum(bu_vote) > 0
2018-09-24 14:22:59  sql=

select bu_bug, count(1)
from bug_user 
where bu_vote = 1
group by bu_bug
2018-09-24 14:22:59 http://192.168.0.31/ajax.aspx?bugid=25 elapsed milliseconds:0090
2018-09-24 14:22:59  elapsed milliseconds:0002
2018-09-24 14:22:59 http://192.168.0.31/ajax.aspx?bugid=25 no previous session, no guest login allowed
2018-09-24 14:22:59 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 14:22:59  elapsed milliseconds:0104
2018-09-24 14:22:59  sql=

select bg_id, 	

isnull(bg_tags,'') bg_tags,
bg_short_desc
from bugs
2018-09-24 14:22:59  elapsed milliseconds:0001
2018-09-24 14:22:59  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
2018-09-24 14:22:59  elapsed milliseconds:0004
2018-09-24 14:22:59  done creating Lucene index
2018-09-24 14:23:00 http://192.168.0.31/default.aspx?url=/ajax.aspx&qs=bugid=25 sql=
select count(1) from users
2018-09-24 14:23:04 http://192.168.0.31/default.aspx sql=
select count(1) from users
2018-09-24 14:42:09 http://192.168.0.31/default.aspx sql=
select count(1) from users
2018-09-24 14:42:16 http://192.168.0.31/default.aspx sql=
select count(1) from users
2018-09-24 14:42:16 http://192.168.0.31/default.aspx sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2018-09-24 14:42:16 http://192.168.0.31/default.aspx elapsed milliseconds:0026
2018-09-24 14:42:16 http://192.168.0.31/default.aspx sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2018-09-24 14:42:16 http://192.168.0.31/default.aspx sql=
select us_id from users where us_username = N'admin'
2018-09-24 14:42:16 http://192.168.0.31/default.aspx elapsed milliseconds:0001
2018-09-24 14:42:16 http://192.168.0.31/default.aspx guid=dcb0488e-27db-4dbf-9d21-0b0cb65c9113
2018-09-24 14:42:16 http://192.168.0.31/default.aspx sql=
insert into sessions (se_id, se_user) values('dcb0488e-27db-4dbf-9d21-0b0cb65c9113', 1)
2018-09-24 14:42:16 http://192.168.0.31/default.aspx AppPath:
2018-09-24 14:42:16 http://192.168.0.31/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'dcb0488e-27db-4dbf-9d21-0b0cb65c9113';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'dcb0488e-27db-4dbf-9d21-0b0cb65c9113'
and us_active = 1
2018-09-24 14:42:16 http://192.168.0.31/bugs.aspx elapsed milliseconds:0037
2018-09-24 14:42:16 http://192.168.0.31/bugs.aspx sql=

/* custom columns */ select sc.name, st.[name] [datatype], 
case when st.[name] = 'nvarchar' or st.[name] = 'nchar' then sc.length/2 else sc.length end as [length], 
sc.xprec, sc.xscale, sc.isnullable,
mm.text [default value], 
dflts.name [default name], 
isnull(ccm_dropdown_type,'') [dropdown type],
isnull(ccm_dropdown_vals,'') [vals],
isnull(ccm_sort_seq, sc.colorder) [column order],
sc.colorder
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
left outer join syscomments mm on sc.cdefault = mm.id
left outer join custom_col_metadata on ccm_colorder = sc.colorder
left outer join sysobjects dflts on dflts.id = mm.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
order by sc.id, isnull(ccm_sort_seq,sc.colorder)
2018-09-24 14:42:16 http://192.168.0.31/bugs.aspx elapsed milliseconds:0101
2018-09-24 14:42:16 http://192.168.0.31/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 14:42:16 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 14:42:16 http://192.168.0.31/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2018-09-24 14:42:16 http://192.168.0.31/bugs.aspx elapsed milliseconds:0001
2018-09-24 14:42:16 http://192.168.0.31/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 14:42:16 http://192.168.0.31/bugs.aspx elapsed milliseconds:0013
2018-09-24 14:42:24 http://192.168.0.31/ajax.aspx?bugid=36 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'dcb0488e-27db-4dbf-9d21-0b0cb65c9113';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'dcb0488e-27db-4dbf-9d21-0b0cb65c9113'
and us_active = 1
2018-09-24 14:42:24 http://192.168.0.31/ajax.aspx?bugid=36 elapsed milliseconds:0000
2018-09-24 14:42:24 http://192.168.0.31/ajax.aspx?bugid=36 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 36
2018-09-24 14:42:24 http://192.168.0.31/ajax.aspx?bugid=36 elapsed milliseconds:0002
2018-09-24 14:42:24 http://192.168.0.31/ajax.aspx?bugid=36 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 36
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 14:42:24 http://192.168.0.31/ajax.aspx?bugid=36 elapsed milliseconds:0007
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'dcb0488e-27db-4dbf-9d21-0b0cb65c9113';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'dcb0488e-27db-4dbf-9d21-0b0cb65c9113'
and us_active = 1
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0000
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 36
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0041
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0023
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 4
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0004
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 4
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0001
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 36
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0000
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'dcb0488e-27db-4dbf-9d21-0b0cb65c9113';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'dcb0488e-27db-4dbf-9d21-0b0cb65c9113'
and us_active = 1
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0001
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 36
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0000
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0001
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 4
		and pu_permission_level = 0)
order by us_username; 
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0000
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 4
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0000
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 36
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2018-09-24 14:42:34 http://192.168.0.31/edit_bug.aspx?id=36 elapsed milliseconds:0000
2018-09-24 14:47:58 http://192.168.0.31/logoff.aspx sql=
delete from sessions
			where se_id = N'dcb0488e-27db-4dbf-9d21-0b0cb65c9113'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 14:47:58 http://192.168.0.31/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 15:47:18  caught exception in util.set_context:Request is not available in this context
2018-09-24 15:47:18  threadproc_votes
2018-09-24 15:47:18  sql=

if exists (select * from dbo.sysobjects where id = object_id(N'[votes_view]'))
drop view [votes_view]
2018-09-24 15:47:18  started creating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 15:47:18  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 15:47:18  sql=

create view votes_view as
select bu_bug as vote_bug, sum(bu_vote) as vote_total
from bug_user
group by bu_bug
having sum(bu_vote) > 0
2018-09-24 15:47:18  sql=

select bu_bug, count(1)
from bug_user 
where bu_vote = 1
group by bu_bug
2018-09-24 15:47:18  elapsed milliseconds:0002
2018-09-24 15:47:18  elapsed milliseconds:0047
2018-09-24 15:47:18  sql=

select bg_id, 	

isnull(bg_tags,'') bg_tags,
bg_short_desc
from bugs
2018-09-24 15:47:18  elapsed milliseconds:0013
2018-09-24 15:47:18  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
2018-09-24 15:47:18  elapsed milliseconds:0003
2018-09-24 15:47:18  done creating Lucene index
2018-09-24 16:15:04 http://localhost/default.aspx sql=
select count(1) from users
2018-09-24 16:15:36 http://localhost/default.aspx sql=
select count(1) from users
2018-09-24 16:15:36 http://localhost/default.aspx sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2018-09-24 16:15:36 http://localhost/default.aspx elapsed milliseconds:0014
2018-09-24 16:15:36 http://localhost/default.aspx sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2018-09-24 16:15:36 http://localhost/default.aspx sql=
select us_id from users where us_username = N'admin'
2018-09-24 16:15:36 http://localhost/default.aspx elapsed milliseconds:0002
2018-09-24 16:15:36 http://localhost/default.aspx guid=ec73bf42-6242-43df-8fa2-aa212d98c441
2018-09-24 16:15:36 http://localhost/default.aspx sql=
insert into sessions (se_id, se_user) values('ec73bf42-6242-43df-8fa2-aa212d98c441', 1)
2018-09-24 16:15:36 http://localhost/default.aspx AppPath:
2018-09-24 16:15:36 http://localhost/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'ec73bf42-6242-43df-8fa2-aa212d98c441';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'ec73bf42-6242-43df-8fa2-aa212d98c441'
and us_active = 1
2018-09-24 16:15:36 http://localhost/bugs.aspx elapsed milliseconds:0063
2018-09-24 16:15:36 http://localhost/bugs.aspx sql=

/* custom columns */ select sc.name, st.[name] [datatype], 
case when st.[name] = 'nvarchar' or st.[name] = 'nchar' then sc.length/2 else sc.length end as [length], 
sc.xprec, sc.xscale, sc.isnullable,
mm.text [default value], 
dflts.name [default name], 
isnull(ccm_dropdown_type,'') [dropdown type],
isnull(ccm_dropdown_vals,'') [vals],
isnull(ccm_sort_seq, sc.colorder) [column order],
sc.colorder
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
left outer join syscomments mm on sc.cdefault = mm.id
left outer join custom_col_metadata on ccm_colorder = sc.colorder
left outer join sysobjects dflts on dflts.id = mm.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
order by sc.id, isnull(ccm_sort_seq,sc.colorder)
2018-09-24 16:15:37 http://localhost/bugs.aspx elapsed milliseconds:0070
2018-09-24 16:15:37 http://localhost/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 16:15:37 http://localhost/bugs.aspx elapsed milliseconds:0002
2018-09-24 16:15:37 http://localhost/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2018-09-24 16:15:37 http://localhost/bugs.aspx elapsed milliseconds:0002
2018-09-24 16:15:37 http://localhost/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 16:15:37 http://localhost/bugs.aspx elapsed milliseconds:0014
2018-09-24 16:21:01 http://localhost/logoff.aspx sql=
delete from sessions
			where se_id = N'ec73bf42-6242-43df-8fa2-aa212d98c441'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 16:21:01 http://localhost/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 16:23:21 http://localhost/default.aspx sql=
select count(1) from users
2018-09-24 16:23:25 http://localhost/default.aspx sql=
select count(1) from users
2018-09-24 16:23:25 http://localhost/default.aspx sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2018-09-24 16:23:25 http://localhost/default.aspx elapsed milliseconds:0000
2018-09-24 16:23:25 http://localhost/default.aspx sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2018-09-24 16:23:25 http://localhost/default.aspx sql=
select us_id from users where us_username = N'admin'
2018-09-24 16:23:25 http://localhost/default.aspx elapsed milliseconds:0000
2018-09-24 16:23:25 http://localhost/default.aspx guid=b8c3a78a-3f76-4f0e-88b8-ce7a560fc396
2018-09-24 16:23:25 http://localhost/default.aspx sql=
insert into sessions (se_id, se_user) values('b8c3a78a-3f76-4f0e-88b8-ce7a560fc396', 1)
2018-09-24 16:23:25 http://localhost/default.aspx AppPath:
2018-09-24 16:23:25 http://localhost/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = 'b8c3a78a-3f76-4f0e-88b8-ce7a560fc396';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = 'b8c3a78a-3f76-4f0e-88b8-ce7a560fc396'
and us_active = 1
2018-09-24 16:23:25 http://localhost/bugs.aspx elapsed milliseconds:0011
2018-09-24 16:23:25 http://localhost/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 16:23:25 http://localhost/bugs.aspx elapsed milliseconds:0000
2018-09-24 16:23:25 http://localhost/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2018-09-24 16:23:25 http://localhost/bugs.aspx elapsed milliseconds:0000
2018-09-24 16:23:25 http://localhost/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 16:23:25 http://localhost/bugs.aspx elapsed milliseconds:0001
2018-09-24 16:23:27 http://localhost/logoff.aspx sql=
delete from sessions
			where se_id = N'b8c3a78a-3f76-4f0e-88b8-ce7a560fc396'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 16:23:27 http://localhost/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 18:24:13  caught exception in util.set_context:Request is not available in this context
2018-09-24 18:24:13  threadproc_votes
2018-09-24 18:24:13  sql=

if exists (select * from dbo.sysobjects where id = object_id(N'[votes_view]'))
drop view [votes_view]
2018-09-24 18:24:13  started creating Lucene index using folder C:\btnet\www\App_Data\lucene_index
2018-09-24 18:24:14  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2018-09-24 18:24:16  sql=

create view votes_view as
select bu_bug as vote_bug, sum(bu_vote) as vote_total
from bug_user
group by bu_bug
having sum(bu_vote) > 0
2018-09-24 18:24:16  sql=

select bu_bug, count(1)
from bug_user 
where bu_vote = 1
group by bu_bug
2018-09-24 18:24:16  elapsed milliseconds:0294
2018-09-24 18:24:16  elapsed milliseconds:0724
2018-09-24 18:24:16  sql=

select bg_id, 	

isnull(bg_tags,'') bg_tags,
bg_short_desc
from bugs
2018-09-24 18:24:16  elapsed milliseconds:0016
2018-09-24 18:24:16  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
2018-09-24 18:24:16  elapsed milliseconds:0004
2018-09-24 18:24:16 http://localhost/default.aspx?msg=logged+off sql=
select count(1) from users
2018-09-24 18:24:16 http://localhost/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2018-09-24 18:24:16 http://localhost/default.aspx?msg=logged+off elapsed milliseconds:0003
2018-09-24 18:24:16  done creating Lucene index
2018-09-24 18:24:16 http://localhost/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2018-09-24 18:24:17 http://localhost/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'admin'
2018-09-24 18:24:17 http://localhost/default.aspx?msg=logged+off elapsed milliseconds:0002
2018-09-24 18:24:17 http://localhost/default.aspx?msg=logged+off guid=5062c3e5-da63-4d58-bc4d-6e5987354dcf
2018-09-24 18:24:17 http://localhost/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('5062c3e5-da63-4d58-bc4d-6e5987354dcf', 1)
2018-09-24 18:24:17 http://localhost/default.aspx?msg=logged+off AppPath:
2018-09-24 18:24:17 http://localhost/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5062c3e5-da63-4d58-bc4d-6e5987354dcf';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5062c3e5-da63-4d58-bc4d-6e5987354dcf'
and us_active = 1
2018-09-24 18:24:18 http://localhost/bugs.aspx elapsed milliseconds:0086
2018-09-24 18:24:18 http://localhost/bugs.aspx sql=

/* custom columns */ select sc.name, st.[name] [datatype], 
case when st.[name] = 'nvarchar' or st.[name] = 'nchar' then sc.length/2 else sc.length end as [length], 
sc.xprec, sc.xscale, sc.isnullable,
mm.text [default value], 
dflts.name [default name], 
isnull(ccm_dropdown_type,'') [dropdown type],
isnull(ccm_dropdown_vals,'') [vals],
isnull(ccm_sort_seq, sc.colorder) [column order],
sc.colorder
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
left outer join syscomments mm on sc.cdefault = mm.id
left outer join custom_col_metadata on ccm_colorder = sc.colorder
left outer join sysobjects dflts on dflts.id = mm.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
order by sc.id, isnull(ccm_sort_seq,sc.colorder)
2018-09-24 18:24:18 http://localhost/bugs.aspx elapsed milliseconds:0653
2018-09-24 18:24:18 http://localhost/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2018-09-24 18:24:18 http://localhost/bugs.aspx elapsed milliseconds:0046
2018-09-24 18:24:18 http://localhost/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2018-09-24 18:24:18 http://localhost/bugs.aspx elapsed milliseconds:0024
2018-09-24 18:24:18 http://localhost/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(bg_project_custom_dropdown_value1,'') [Version], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2018-09-24 18:24:19 http://localhost/bugs.aspx elapsed milliseconds:0134
2018-09-24 18:24:24 http://localhost/logoff.aspx sql=
delete from sessions
			where se_id = N'5062c3e5-da63-4d58-bc4d-6e5987354dcf'
			or datediff(d, se_date, getdate()) > 2
2018-09-24 18:24:24 http://localhost/default.aspx?msg=logged+off sql=
select count(1) from users
